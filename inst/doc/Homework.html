<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22074" />

<meta name="date" content="2022-12-05" />

<title>Homework to StatComp22074</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework to StatComp22074</h1>
<h4 class="author">22074</h4>
<h4 class="date">2022-12-05</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>StatComp22074</strong> is a simple R package, which shows all
the answers to the past homework of 22074, including all the contents of
HW0-HW10.</p>
</div>
<div id="hw0" class="section level2">
<h2>HW0</h2>
<div id="question" class="section level3">
<h3>Question</h3>
<p>Use knitr to produce at least 3 examples (texts, figures,
tables).</p>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<div id="example-1" class="section level4">
<h4>Example 1</h4>
<p>We can import the CARS dataset containing 50 pieces of data, which
give the speed of cars and the distances taken to stop. Store the data
in the variable Speed and Dist, and display some of the data as
follows.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Speed <span class="ot">&lt;-</span> cars<span class="sc">$</span>speed</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Dist <span class="ot">&lt;-</span> cars<span class="sc">$</span>dist</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xtable<span class="sc">::</span><span class="fu">xtable</span>(<span class="fu">head</span>(cars)),<span class="at">type =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<!-- html table generated in R 4.2.1 by xtable 1.8-4 package -->
<!-- Mon Dec  5 20:04:45 2022 -->
<table border="1">
<tr>
<th>
</th>
<th>
speed
</th>
<th>
dist
</th>
</tr>
<tr>
<td align="right">
1
</td>
<td align="right">
4.00
</td>
<td align="right">
2.00
</td>
</tr>
<tr>
<td align="right">
2
</td>
<td align="right">
4.00
</td>
<td align="right">
10.00
</td>
</tr>
<tr>
<td align="right">
3
</td>
<td align="right">
7.00
</td>
<td align="right">
4.00
</td>
</tr>
<tr>
<td align="right">
4
</td>
<td align="right">
7.00
</td>
<td align="right">
22.00
</td>
</tr>
<tr>
<td align="right">
5
</td>
<td align="right">
8.00
</td>
<td align="right">
16.00
</td>
</tr>
<tr>
<td align="right">
6
</td>
<td align="right">
9.00
</td>
<td align="right">
10.00
</td>
</tr>
</table>
<p>At the same time, we can output basic information of the CARS
dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cars)</span></code></pre></div>
<pre><code>##      speed           dist       
##  Min.   : 4.0   Min.   :  2.00  
##  1st Qu.:12.0   1st Qu.: 26.00  
##  Median :15.0   Median : 36.00  
##  Mean   :15.4   Mean   : 42.98  
##  3rd Qu.:19.0   3rd Qu.: 56.00  
##  Max.   :25.0   Max.   :120.00</code></pre>
</div>
<div id="example-2" class="section level4">
<h4>Example 2</h4>
<p>We can performe linear regression analysis on the CARS dataset.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lm.cars <span class="ot">&lt;-</span> <span class="fu">lm</span>(Dist<span class="sc">~</span>Speed)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.cars)<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) -17.579095  6.7584402 -2.601058 1.231882e-02
## Speed         3.932409  0.4155128  9.463990 1.489836e-12</code></pre>
<p>We can output the text version of the results as above and obtain the
estimation of regression equation as,</p>
<p><span class="math display">\[Dist=-17.579095+3.932409\times
Speed\]</span></p>
<p>also we can discover that <span class="math inline">\(p-value\)</span> of Speed is <span class="math inline">\(1.489836e-12\)</span>. Therefore, we can assume
that the distances taken to stop is affected by the speed of cars at the
significance level of <span class="math inline">\(\alpha
=0.05\)</span>.</p>
</div>
<div id="example-3" class="section level4">
<h4>Example 3</h4>
<p>We can also plot the regression results as follows, and it can be
found that the linear model fits well.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.cars)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw1" class="section level2">
<h2>HW1</h2>
<p>HW1 is used to generate random numbers.</p>
<div id="question-3.3" class="section level3">
<h3>Question 3.3</h3>
<p>For the Pareto(a,b) distribution <span class="math display">\[F(x)=1-(\frac{b}{x})^a,x\geq
b&gt;0,a&gt;0.\]</span> We need to derive <span class="math inline">\(F^{-1}(U)\)</span> and use it to simulate sample
from Pareto(2,2). Besides, we need to graph the density histogram of
samples and Pareto(2,2).</p>
<p>Exercise1 of HW1 mainly generated random numbers with Pareto(2,2)
distributions and drew corresponding histograms.</p>
</div>
<div id="answer-3.3" class="section level3">
<h3>Answer 3.3</h3>
<p>Since <span class="math inline">\(X\)</span> is a continuous random
variable with cdf <span class="math inline">\(F_X(x)\)</span>, <span class="math inline">\(U=F_X(X)\sim U(0,1)\)</span>, and <span class="math inline">\(F^{-1}_X(U)\)</span> has the same distribution as
<span class="math inline">\(X\)</span>. We can make <span class="math display">\[F(x)=1-(\frac{b}{x})^a=u,u\in [0,1), x\geq
b&gt;0,a&gt;0\]</span> <span class="math display">\[1-u=(\frac{b}{x})^a\]</span> <span class="math display">\[(1-u)^{1/a}=\frac{b}{x}\]</span> <span class="math display">\[F^{-1}(u)=x=\frac{b}{(1-u)^{1/a}},u\in
[0,1),a&gt;0\]</span></p>
<p>Thereforce, we have <span class="math display">\[F^{-1}(U)=\frac{b}{(1-U)^{1/a}},a&gt;0,U\sim
U(0,1).\]</span></p>
<p>Then we can use the inverse transform method to simulate a random
sample from the Pareto(2, 2) by making <span class="math inline">\(a=b=2\)</span>, and use <span class="math inline">\(n=1000\)</span>.</p>
<p>Since we know when <span class="math inline">\(U\sim U(0,1)\)</span>,
<span class="math inline">\(U&#39;=1-U\sim U(0,1)\)</span>, we can make
<span class="math inline">\(F^{-1}(U&#39;)=\frac{b}{(U&#39;)^{1/a}},a&gt;0,U&#39;\sim
U(0,1)\)</span>. Besides, we can easily know <span class="math display">\[f(x)=\frac{8}{x^3},x\geq 2.\]</span></p>
<ol style="list-style-type: decimal">
<li><p>Generate <span class="math inline">\(U&#39;\sim
U(0,1)\)</span>.</p></li>
<li><p>Return <span class="math inline">\(X=F^{-1}(U&#39;)\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rdistPareto <span class="ot">=</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="fl">1e3</span>,<span class="at">a =</span> <span class="dv">2</span>,<span class="at">b =</span> <span class="dv">2</span>,<span class="at">picture =</span> <span class="cn">FALSE</span>){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n) <span class="co"># Generate uniformly distributed random numbers</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> b<span class="sc">/</span>(u)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>a) <span class="co"># calculate F^(-1)(U&#39;)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(picture){</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw a histogram</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="st">&#39;scott&#39;</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>a<span class="sc">*</span>b<span class="sc">^</span>a<span class="sc">/</span>x<span class="sc">^</span>(a<span class="sc">+</span><span class="dv">1</span>),x<span class="sc">&gt;=</span>b))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sampling and plotting probability density curves</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    sampling <span class="ot">&lt;-</span> <span class="fu">seq</span>(b,<span class="fu">max</span>(x),.<span class="dv">1</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(sampling,a<span class="sc">*</span>b<span class="sc">^</span>a<span class="sc">/</span>sampling<span class="sc">^</span>(a<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rdistPareto</span>(<span class="fl">1e3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="question-3.7" class="section level3">
<h3>Question 3.7</h3>
<p>Question 3.7 is a function to generate a random sample of size n from
the Beta(a, b) distribution by the acceptance-rejection method and graph
the histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
</div>
<div id="answer-3.7" class="section level3">
<h3>Answer 3.7</h3>
<p>In order to generate random sample from Beta(a,b) with the pdf as
follow,</p>
<p><span class="math display">\[f(x ; \alpha,
\beta)=\frac{x^{\alpha-1}(1-x)^{\beta-1}}{\int_{0}^{1}
u^{\alpha-1}(1-u)^{\beta-1} d
u}=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha) \Gamma(\beta)}
x^{\alpha-1}(1-x)^{\beta-1}=\frac{1}{B(\alpha, \beta)}
x^{\alpha-1}(1-x)^{\beta-1},\alpha,\beta&gt;0,x\in (0,1)\]</span>
Thereforce, we can choose <span class="math inline">\(g(x)=1,0&lt;x&lt;1\)</span> and <span class="math inline">\(c = \frac{1}{B(\alpha, \beta)}\)</span>, which
make</p>
<p><span class="math display">\[f(x ; \alpha, \beta)=\frac{1}{B(\alpha,
\beta)} x^{\alpha-1}(1-x)^{\beta-1}\leq \frac{1}{B(\alpha, \beta)} =
cg(x),x\in(0,1)\]</span> and <span class="math display">\[\rho(x)=\frac{f(x)}{cg(x)}=x^{\alpha-1}(1-x)^{\beta-1},x\in(0,1).\]</span>
Then we can use the acceptance-rejection method as follow to generate a
random sample of size <span class="math inline">\(n=1000\)</span> when
<span class="math inline">\(\alpha=3,\beta=2\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>rdistBETA <span class="ot">=</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="fl">1e3</span>,<span class="at">alpha =</span> <span class="dv">3</span>,<span class="at">beta =</span> <span class="dv">2</span>,<span class="at">picture =</span> <span class="cn">FALSE</span>){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  sample_total <span class="ot">&lt;-</span> m <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># draw the mth sample and Output sampling total</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co"># Record the generated random numbers</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(m <span class="sc">&lt;</span> n)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># Generate random numbers from U(0,1)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    sample_total <span class="ot">&lt;-</span> sample_total <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># Generate random numbers from g(x)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u <span class="sc">&lt;=</span> x<span class="sc">^</span>(alpha<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(beta<span class="dv">-1</span>)) <span class="co"># Determine whether u &lt;= rho(x)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>      <span class="co"># accept x and record it</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>      m <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>      y[m] <span class="ot">&lt;-</span> x</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(picture){</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw a histogram</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="st">&#39;scott&#39;</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>x<span class="sc">^</span>(alpha<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(beta<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">B</span>(alpha,beta)))</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sampling and plotting probability density curves</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    sampling <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(sampling,sampling<span class="sc">^</span>(alpha<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>sampling)<span class="sc">^</span>(beta<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">beta</span>(alpha,beta))</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rdistBETA</span>(<span class="fl">1e3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>We can find that the coincidence degree between the histogram drawn
by the generated samples and the probability density curve is very high,
that is, it can be considered that the generated random samples are from
<span class="math inline">\(Beta(\alpha=3,\beta=2)\)</span>.</p>
</div>
<div id="question-3.12-3.13" class="section level3">
<h3>Question 3.12 &amp; 3.13</h3>
<p>The purpose of the question is to simulate a continuous
Exponential-Gamma mixture with the rate parameter <span class="math inline">\(\Lambda\sim\)</span>Gamma(<span class="math inline">\(r, \beta\)</span>) and <span class="math inline">\(Y\sim\)</span>Exp(<span class="math inline">\(\Lambda\)</span>). Therefore, we have <span class="math inline">\((Y|\Lambda=\lambda)\sim f_Y (y|\lambda) = \lambda
e^{−\lambda y}\)</span>. Besides, generate <span class="math inline">\(n=1000\)</span> random observations from this
mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>.</p>
</div>
<div id="answer-3.12-3.13" class="section level3">
<h3>Answer 3.12 &amp; 3.13</h3>
<p>Firstly, we can generate Gamma distributed random number <span class="math inline">\(\lambda\sim Gamma(r,\beta)\)</span> for <span class="math inline">\(n=1000\)</span> times, and then use each <span class="math inline">\(\lambda\)</span> to get the random sample <span class="math inline">\(y_i\sim\)</span>Exp(<span class="math inline">\(\lambda_i\)</span>) with <span class="math inline">\(i=1,...,n\)</span>.</p>
<p>In Exercise 3.12 we have generated random sample <span class="math inline">\(y\)</span> from this mixture distribution.</p>
<p>Therefore, we can then calculate the probability density function of
this distribution according to its distribution function.</p>
<p><span class="math display">\[f(y)=F&#39;(y)=-r(\frac{\beta}{\beta+y})^{r-1}(-\frac{\beta}{(\beta+y)^2})=\frac{r\beta^r}{(\beta+y)^{r+1}},y\geq
0.\]</span> Thus, we can plot histograms against samples and
subsequently sample and plot theoretical probability density curves with
<span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rdistGammaExp <span class="ot">=</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="fl">1e3</span>,<span class="at">r =</span> <span class="dv">4</span>,<span class="at">beta =</span> <span class="dv">2</span>,<span class="at">picture =</span> <span class="cn">FALSE</span>){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  lambda_sampling <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,r,beta) <span class="co"># Generate gamma distributed random numbers</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(lambda_sampling) <span class="co"># the length of x and lambda is n = 1000</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(picture){</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw a histogram to show the random sample</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="st">&#39;scott&#39;</span>,<span class="at">main =</span> <span class="fu">expression</span>(y <span class="sc">%~%</span> <span class="fu">Exp</span>(lambda <span class="sc">%~%</span> <span class="fu">Gamma</span>(r,beta))))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sampling and plotting probability density curves</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    sampling <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,.<span class="dv">01</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(sampling,r<span class="sc">*</span>beta<span class="sc">^</span>r<span class="sc">/</span>(beta<span class="sc">+</span>sampling)<span class="sc">^</span>(r<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rdistGammaExp</span>(<span class="fl">1e3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>We can find that the coincidence degree between the density histogram
of the sample and the theoretical (Pareto) probability density curve is
very high. Therefore, it can be considered that the shape of empirical
and theoretical (Pareto) distributions is similar.</p>
</div>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
<p>The main task of HW2 is to test the performance of Monte Carlo
method.</p>
<div id="exercise-1" class="section level3">
<h3>Exercise 1</h3>
<ol style="list-style-type: decimal">
<li>For <span class="math inline">\(n = 10^4, 2 \times 10^4, 4 \times
10^4, 6 \times 10^4, 8 \times 10^4\)</span>, apply the fast sorting
algorithm to randomly permuted numbers of <span class="math inline">\(1,
. . . , n\)</span>.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := n log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>HW2_Ex1 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">100</span>){</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  sample_n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>) <span class="sc">*</span><span class="fl">1e4</span> <span class="co"># The array size</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  test_time_sample <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(sample_n)) <span class="co"># record spending time</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate time</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_n)){</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    test_number<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>sample_n[i])</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    test_time_sample[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="fu">quick_sort</span>(test_number))[<span class="dv">1</span>]<span class="sc">/</span>n</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;The average time:&#39;</span>,test_time_sample)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> sample_n<span class="sc">*</span><span class="fu">log</span>(sample_n)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  t_test_time_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(t<span class="sc">~</span>test_time_sample) <span class="co"># linear regression</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(t_test_time_lm)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># graph the scatter plot and regression line</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(test_time_sample,t,<span class="at">main=</span><span class="st">&quot;Scatter plots and regression line&quot;</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(t_test_time_lm,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">legend=</span><span class="st">&quot;Regression line&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HW2_Ex1</span>(<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## The average time: 0.0681 0.0947 0.1903 0.2856 0.3833</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa2tma225C227a229u22/+2/9u2///bkDrbkGbbtmbbtpDb27bb29vb/7bb////AAD/tmb/25D/27b//7b//9v///+hJdTuAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMp0lEQVR4nO2dDZubuBHH8Z5TO016qZ1ce7nzNumlNenrbZde0u7itfX9v9RJoxcEWIwFEhbs/J9nvVhIGunnQRIgRMZIncquXYDURYAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECFED0Okfr7Js8e1dR4rT3+7NJ67Tbfbi4VwGXsqzG+80nTpTrHMx+EfWDAUtds6ET+9EWeVnr5JcnNRSMoCKTMldHlnWi0vcLkmfygYHhEsXvA4ozxY/8t+YcwMX+oUfb9/8KLa+vOPUXu9FDIHvDwri6TP3tjcinyJb/PQuu7lT2dz8+7ssW95Vdr7w7998/6AzuGf/bRzLxoLI6q883+Ueyvl5nS0/VYCMnco0bC73EOfcbsuS2WwVq26VuTxIFeSwzjZM1SUTm6U68vZ1QMctBC/vte8pZ1EJRXxVEuWafFMBKhqeWlkwbiy29TFvAZL5WKZlnMUrCai127JUbbaKVbPqBsRjLb7/uSrz7x+etjw/Hu83DwqbfYjl4reSwTzlizv2P81Z7Pgly1aqJDwO/ywykwGvwOpBxNiY4hgLBfheoX+Z1YPwBgsQ2LFMyzh5pgA1dluWrM12sWyrbkDqB1t+ejDuVHwrgX0V/duqBogb3ECZZcmqhj2XX3LJFtwGKgj/4IMXbfkzq0tbkFnxGMbacWsDElnbpu047d2WJWuzXSzbqhuQbHakb9rN6+mD9L86IJ6bccvC+KZBC2Hazgt1nO/lTvlLyKO/aUFmJX5uEW1lZaizYLZpnblug9q7taX6ZqNYltVOQHzP14/rzCqccqzln79uG4DKrBsQ378DO9qsCFA7n97JlH9pW7CKqhO2AFmma3Hau21L1Wa7WBcBUo2zfXBY4ccmIB5sDitPD+J6+viqatZtC3UPqryj4UHatMODrJGcZUlv9vQgvnvxnif5sq6O7fL1J4m43UhXubUAYW2QKsSf9LZtwS7qmTYI7Nim621Qa3fDktw81wZdcoiZgaKIxgv9BqLsoLUXoyPz+8pPGDbxfg66gjogdy8GMaGHFC5feVDDgiyq3UPVfgjLdL0Xa+62LFmbjmKhgOrDjlyzMsGyyHyv/FSjjYpYBcg94JBJP7dGHeca6VpWNUCW6fo4qLXbslRtnhsHXdRIn6AX070LjKTfM9nHLD8VevC8vJOf7OkDb89hkNpsg/7zQe6oDVnfgwmZFAy9NiNpy0KtqKe/r/lgvtUGMcs05Pi7O7sNqu22LJnNdrEu78UC6AqnTsIocvrZTzMAxI/CN/YQL6xmAEgPeqxjPKBmAIg9fbfGrvL1F11yRUSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQ+gI5bMXuozLpmCc9O3oAKcQf8uHXPNJ+ZfAEpNEWUiQIpyhfQYQ2AymdzkAX2oGwyigNI5LxiurkemN005FkjMc1TzDB08CFAI2eXgAgQIr8a6cmozj7smQMqdNvjbISeN6DTrcHi7OaHlic5+XXz5gTDNVB83oDIgzAV+hkaaoMcUo9AuOe0P3dAY2eXgAgQIv8adV7pIEDRAOlBuus0uEPO65t8x+BrnwkBUg/YBryYG+LKsGeN1CN6zQdr/K9DtaQAqX9hdAVALLYHsVw/KgnHWs5/jI+L/fHtR73whAiGx+J35r/kUMqdx+0PW73IgTrEqqDC/xiOC+ixS/WotgcV3EMPa/GINTydL56NB2wqGK6Ll+JZY/kfAJVASjxqL57x1k+uKkAqyOTrodQ8qIB6bqQdeYcgF4A2rArWJdD/BQR5GlSqqOrWggEkg0wGPuVKZhyke7EdVJNBjWRdoNZ28HEr61j93ykksHNnGh8DSAaZDMapUeDswIMOa+FG+hnLXVEHpIMlzB3T/ytAul93ADIZxKzRUTytn4e/aC8PMTgLLnUnec6DtHL1LZd7L/cgT/nWiBspxLIgwc/mVRsk6m16Z1nrQgGqd9r6m4JgtUFOQL16fc8aiXKIa0FF8AtmChD0V9AJCVRVL6ZIQTB4Qln9b/RiTkBVvh7yvi+2A0DhryjqcVChloMyq2Pc/FOsgSHv56rgUo1V1f/GOMgNqMr3cvX0oHzEK4rXnQfQrw0qXD1BWEDQBjnbu3HUpxfrWOQgsAeV3r1ycCUzDkpVBAiRX414p7LSw9gA2U1Bfrd9YN2vFc0PcghGq3K8TjcOz0mOWOX5Ed16PiPyIEymDbLu0g/IbhKiXgxR6HHQZHQtQGGz69IjHqVDswfUvCniq7kDGohndED+h/YgDXUfNnMPGo5n1oACuA+bMaAweOYLKBCeuQIK5T5spoDC4ZkloIDuw+YIKCie+QEK6z5sdoBC4+kD6PhW3gwcdqM3CqDg7sOGAHLN2whs93LFwOMPKK9ONwfdCQ8PKAqeIR40kt0LFcd92Gwa6Vh4ZgIomvuweQCKiGcOgGK6D5syIHXZNi6eCQPK4C+y+7DpApLeEx3PtAE9jnFle7qAhPsQILceQ2RygSZ645C7z0g3H6fpQSM0zlpTBDRG52U0QUBj4pkgoFHdh0UCdMFit30BjYwnJqDuxW77ARrbfVhEQNhSpR7ZaV0BT0RAyGK3PQBdA8+EPOgq7sOiARJj5aCL3V4JT7xuPuxit9dyHzaRcdD18EwC0BXdh0UDFHCx26viiQUo3GK313UfFglQsKVKr44nWjcfZrHb6+NJ2oMScB8Wrw0avthtEnii9WKDF7tNw31YsuOgVPAkCigZ92FRAfkuE2ju4ySEJyVAmfpLyX1YQoAy9ZkWnniAvBe7lQGJuQ9LzIMeH0e5m+ylZADB0ZUen4QAcfdJkE8646DkGh+lRACl1zhrxQPks9htsngiAvJY7DZd92HxAHksdpsynpj3xS5c7DZp92HxPahzsdssSx1P9Daoc7HbRIeGdUXtxboXu5XukzqhK46DHmPkG1xXA6RPTJ8pIHG1Q84PcvRi+uhKnU+s2z6wgLyYINQ5Dhprpa4hinjj8HQb5a0IIyvqrWc+CHICmoxiADK3nvOV3/oMTiMj7Bjq035tkHkdk9/bKZ4NIHNz/nRLgEKKAPU1QoAQIwQIMUKAECMECDFCgKYvAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBCiSIDK+gSHw2/vz4Q6U8CzwxufFOKer/zSlaKP4gASL0Isq3Iet/LNkfVQZ4rTLd8oxBIPl6aA+y367erOFL0UBZC8gZav1NdSPkfeCHWnkAuo8DpfnALmTIoXsnel6KcogEwN4VuZbWDGXj20K4VMttj7pRCAulL0UxxAL4WPW/MYJaBmaFcK7gY3934pxNSKrhT9FAWQbASspgBK3ArtSgHPDfukKKFZ70rRT6kCKnUbfTlSMe1kIoCGH2LyuXPPg1K0WtM4xFpNpW8jrRYJ8WzWedBEGulWZ1t6dfPWHAmvgUHZPTDop1EGivoV4xcO+w7rzZnQThtiYrt5V3f6A0Uz8hdDEyHVKBQdpwFWCuvB2AtTyFfL7DAbfUQnq4gIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChGgkQOW5ReFqgfyL882J3gqX00iAzha4FhiwSmFzI0CIRgF0WMO7Sgo1f158zXYq0Irxf16tw/qHLY8lvsNcMT3l3s4K9qj5LrX4h5c/rSE+AGql7aURPQim6a7VizbLbNfyoCMAgln2N/cwj04nMdJpYRKZ3GvF55h2sBdWVG2m7afxAKn3/N7c6ymWDkAbpj92JomJZtK+3UtatfiSB6xWfCZtP40HSE6Mg2rLUjsA7Zj5MEmsaNbMUDiq7PhqquJiz3Nqp+2nEQGp1dV28mGe3SWATBIjlVY0MDf/WjcBvVSzpAWgdtpeGtuDtHKoRT2Gw4NaytVTHIdOQIFmKo7ZBu3qITggR28tqg9T99uHGEwCVm1QmJ5+LEAb2emIX18/11Vb912/JrlWYZPERNNpxc7jNts0AcFbcqterJa2n0Y61cj1OEj+8nKqbm6/yC3X4yAbkEliVNrzg+1jTQL6oxw/mXHQ8Cn3szpZHd5ntUWAEF0XEJw46Fn1g6PNENAERIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQvQraNCSQngzU3UAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>We can find that the scatter is distributed near the regression line
and the linear regression result of <span class="math inline">\(a_n\)</span> is significant, so it can be
considered that the computation amount of the quicksort algorithm is
almost <span class="math inline">\(O(n log(n))\)</span> level.</p>
</div>
<div id="question-5.6" class="section level3">
<h3>Question 5.6</h3>
<p>Consider the antithetic variate approach to calculate <span class="math display">\[\theta=\int_0^1e^xdx\]</span> Compute <span class="math inline">\(Cov(e^U , e^{1−U} )\)</span> and <span class="math inline">\(V ar(e^U + e^{1−U} )\)</span>, where <span class="math inline">\(U\sim Uniform(0,1)\)</span>. Estimate the percent
reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC).</p>
<p>Since <span class="math inline">\(U\sim Uniform(0,1)\)</span>, we can
easily get that <span class="math inline">\(1-U\sim
Uniform(0,1)\)</span> and,</p>
<p><span class="math display">\[Cov(e^U , e^{1−U}
)=E(e^Ue^{1−U})-E(e^{U})E(e^{1−U})=e-E(e^{U})E(e^{1−U})\]</span></p>
<p>where <span class="math inline">\(E(e^{1−U})=E(e^{U})=\int_0^1
e^udu=e-1\)</span>.</p>
<p>Therefore, <span class="math inline">\(Cov(e^U , e^{1−U}
)=e-(e-1)^2=-e^2+3e-1\approx -0.2342106\)</span>. And,</p>
<p><span class="math display">\[V ar(e^U + e^{1−U} ) = Var(e^U)+V
ar(e^{1−U} )+2Cov(e^U , e^{1−U} )\]</span> where <span class="math inline">\(V ar(e^U)=V
ar(e^{1-U})=E(e^{2U})-E(e^{U})^2=\int_0^1
e^{2u}du-(e-1)^2=\frac{e^2-1}{2}-(e-1)^2=(e-1)(\frac{e+1}{2}-(e-1))=\frac{(e-1)(3-e)}{2}\)</span>.</p>
<p>Thus, <span class="math inline">\(V ar(e^U + e^{1−U} ) = (e-1)(3-e) +
2(-e^2+3e-1)=-3e^2+10e-5\approx 0.01564999\)</span>.</p>
<p>If we take <span class="math inline">\(2n\)</span> samples,
considering the antithetic variate approach, we have</p>
<p><span class="math display">\[\hat{\theta}=\frac{1}{n}\sum_{i=1}^n\frac{e^{U_i}+e^{1-U_i}}{2}\]</span>
also we have simple MC estimator as</p>
<p><span class="math display">\[\hat{\theta}_{MC}=\frac{1}{2n}\sum_{i=1}^{2n}e^{U_i}\]</span></p>
<p>with <span class="math inline">\(U_i\sim U(0,1)\)</span> i.i.d. for
<span class="math inline">\(i=1,...,2n\)</span>.</p>
<p>Also we can get the theoretical variance of <span class="math inline">\(\hat{\theta}\)</span> and <span class="math inline">\(\hat{\theta}_{MC}\)</span>.</p>
<p><span class="math display">\[Var(\hat{\theta})=\frac{1}{n^2}\sum_{i=1}^nVar(\frac{e^{U_i}+e^{1-U_i}}{2})=\frac{1}{4n}Var(e^{U}+e^{1-U})=\frac{-3e^2+10e-5}{4n}\]</span>
<span class="math display">\[Var(\hat{\theta}_{MC})=\frac{1}{4n^2}\sum_{i=1}^{2n}Var(e^{U_i})=\frac{1}{2n}Var(e^{U})=\frac{(e-1)(3-e)}{4n}\]</span></p>
<p><span class="math display">\[(Var(\hat{\theta}_{MC})-Var(\hat{\theta}))/Var(\hat{\theta}_{MC})=1-Var(\hat{\theta})/Var(\hat{\theta}_{MC})=1-\frac{-3e^2+10e-5}{(e-1)(3-e)}\approx
0.9676701\]</span> Therefore, the percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates is 0.9676701 which can be said as 96.76701%.</p>
</div>
<div id="question-5.7" class="section level3">
<h3>Question 5.7</h3>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>HW2_Q_5_7 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="fl">1e3</span>){</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2</span><span class="sc">*</span>n) <span class="co"># Take the first n random numbers for Uniform distribution</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  u1 <span class="ot">&lt;-</span> u[<span class="dv">1</span><span class="sc">:</span>n] <span class="co"># Take the first n random numbers</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  theta_MC <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(u)) <span class="co"># simple MC estimator</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">exp</span>(u1)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>u1))<span class="sc">/</span><span class="dv">2</span>) <span class="co"># antithetic variate approach</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Simple MC estimator:&#39;</span>,theta_MC,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Antithetic Variate estimator:&#39;</span>,theta,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  var_theta <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">exp</span>(u1)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>u1))) <span class="sc">/</span> (<span class="dv">4</span><span class="sc">*</span>n) <span class="co"># variance of antithetic variate approach</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  var_theta_MC <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(u)) <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>n) <span class="co"># variance of simple MC estimator</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;The percent reduction in variance:&#39;</span>,<span class="dv">1</span> <span class="sc">-</span> var_theta <span class="sc">/</span> var_theta_MC)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We have the simple MC estimator <span class="math inline">\(\hat{\theta}_{MC}=1.711716\)</span> and the
estimator <span class="math inline">\(\hat{\theta}=1.718079\)</span> by
antithetic variate approach which are both similar to the theoretical
results <span class="math inline">\(\theta = \int_0^1e^xdx=e-1\approx
1.718282\)</span>.</p>
<p>Besides, as mentioned above, we can get the theoretical variance of
<span class="math inline">\(\hat{\theta}\)</span> and <span class="math inline">\(\hat{\theta}_{MC}\)</span>.</p>
<p><span class="math display">\[Var(\hat{\theta})=\frac{-3e^2+10e-5}{4n}\]</span>
and <span class="math display">\[Var(\hat{\theta}_{MC})=\frac{(e-1)(3-e)}{4n}\]</span>
and have <span class="math display">\[(Var(\hat{\theta}_{MC})-Var(\hat{\theta}))/Var(\hat{\theta}_{MC})=1-Var(\hat{\theta})/Var(\hat{\theta}_{MC})=1-\frac{-3e^2+10e-5}{(e-1)(3-e)}\approx
0.9676701\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HW2_Q_5_7</span>(<span class="fl">1e3</span>)</span></code></pre></div>
<pre><code>## Simple MC estimator: 1.711716 
## Antithetic Variate estimator: 1.718079 
## The percent reduction in variance: 0.9680734</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>Therefore, the empirical estimate of the percent reduction in
variance of <span class="math inline">\(\hat{\theta}\)</span> that can
be achieved using antithetic variates is 0.9680734 nearly 96.8%, which
is similar to the theoretical value <span class="math inline">\(1-\frac{-3e^2+10e-5}{(e-1)(3-e)}\approx
0.9676701\)</span>.</p>
</div>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
<p>HW3 is mainly a test of importance sampling and hierarchical
importance sampling.</p>
<div id="question-5.13" class="section level3">
<h3>Question 5.13</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1,\]</span>
Determine and explain which of the importance functions should produce
the smaller variance in estimating</p>
<p><span class="math display">\[\int_1^{+\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx.\]</span></p>
</div>
<div id="answer-5.13" class="section level3">
<h3>Answer 5.13</h3>
<p>To find an importance function similar to <span class="math inline">\(g(x)\)</span> with supported on <span class="math inline">\((1,\infty)\)</span>, we can first plot the
function of <span class="math inline">\(g(x)\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.01</span>) <span class="co">#sampling</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="co"># function of g(x)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">col =</span> <span class="st">&#39;black&#39;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;y&#39;</span>,<span class="at">main =</span> <span class="st">&#39;Graph of g(x)&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then we choose to find a function that has tail approximately zero,
and a larger value near 1.</p>
<p>Therefore, we consider <span class="math display">\[f_1(x)=c_1e^{-x},x&gt;1,\]</span> <span class="math display">\[f_2(x)=c_2e^{-x/2},x&gt;1.\]</span> And choose
<span class="math inline">\(c_1\)</span> and <span class="math inline">\(c_2\)</span> to make the integration of <span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> equal to 1.</p>
<p><span class="math display">\[1/c_1=\int_1^{+\infty}
e^{-x}dx=e^{-1}\]</span> <span class="math display">\[1/c_2=\int_1^{+\infty}
e^{-x/2}dx=2e^{-1/2}\]</span></p>
<p>Therefore, we have <span class="math display">\[f_1(x)=e^{-(x-1)},x&gt;1,\]</span> <span class="math display">\[f_2(x)=\frac{1}{2}e^{-(x-1)/2},x&gt;1.\]</span></p>
<p>Then we have the cdf as followed,</p>
<p><span class="math display">\[F_1(t) = \int_1^t e^{-(x-1)} dx =
1-e^{-(t-1)},t&gt;1,\]</span> <span class="math display">\[F_2(t) =
\int_1^t \frac{1}{2}e^{-(x-1)/2} dx = 1-e^{-(t-1)/2},t&gt;1,\]</span>
and make <span class="math inline">\(F_1(t) = U_1\)</span> and <span class="math inline">\(F_2(t) = U_2\)</span> with <span class="math inline">\(U_1,U_2\sim U(0,1)\)</span> and obtain the formula
for random number generation.</p>
<p><span class="math display">\[X_1 = - log(1-U_1) +1,X_1\sim
F_1,\]</span> <span class="math display">\[X_2 = - 2log(1-U_2)
+1,X_2\sim F_2.\]</span> We generate <span class="math inline">\(n=1e4\)</span> random numbers.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="co"># random numbers size</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)) <span class="sc">+</span> <span class="dv">1</span> <span class="co"># X1~F1</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)) <span class="sc">+</span> <span class="dv">1</span> <span class="co"># X2~F2</span></span></code></pre></div>
<p>Then, from the theory of importance sampling, we can get</p>
<p><span class="math display">\[\int g(x)dx=\int
\frac{g(x)}{f(x)}f(x)dx=E_f(\frac{g(x)}{f(x)})\]</span></p>
<p>So we can get two important sampling estimators of <span class="math display">\[\int_1^{+\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span>
as follows.</p>
<p><span class="math display">\[\hat{\theta}_1 = \frac{1}{n}\sum_{i=1}^n
\frac{g(X_{1i})}{f_1(X_{1i})},X_{1i}\sim F_1, i=1,...,n,\]</span> <span class="math display">\[\hat{\theta}_2 = \frac{1}{n}\sum_{i=1}^n
\frac{g(X_{2i})}{f_2(X_{2i})},X_{2i}\sim F_2, i=1,...,n,\]</span> And
<span class="math display">\[Var(\hat{\theta}_1) =
\frac{1}{n^2}Var(\sum_{i=1}^n
\frac{g(X_{1i})}{f_1(X_{1i})})=\frac{1}{n}Var(\frac{g(X_{1})}{f_1(X_{1})})\]</span>
<span class="math display">\[Var(\hat{\theta}_2) =
\frac{1}{n^2}Var(\sum_{i=1}^n
\frac{g(X_{2i})}{f_2(X_{2i})})=\frac{1}{n}Var(\frac{g(X_{2})}{f_2(X_{2})})\]</span></p>
<p>Also, we can use the sample variance to estimate the variance.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>theta_hat1 <span class="ot">&lt;-</span> x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> x1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">/</span> <span class="fu">exp</span>(<span class="sc">-</span> (x1 <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>theta_hat2 <span class="ot">&lt;-</span> x2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> x2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span> (x2 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>var_theta1 <span class="ot">&lt;-</span> <span class="fu">var</span>(theta_hat1) <span class="sc">/</span> n <span class="co"># variance of f1 important sampling</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>var_theta2 <span class="ot">&lt;-</span> <span class="fu">var</span>(theta_hat2) <span class="sc">/</span> n <span class="co"># variance of f2 important sampling</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(theta_hat1),<span class="fu">mean</span>(theta_hat2)))</span></code></pre></div>
<pre><code>## [1] 0.3968767 0.4000743</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(var_theta1,var_theta2))</span></code></pre></div>
<pre><code>## [1] 2.509930e-06 9.093186e-06</code></pre>
<p>We can find that <span class="math inline">\(Var(\hat{\theta}_1) &lt;
Var(\hat{\theta}_2)\)</span>. In other words, sampling the importance of
<span class="math inline">\(f_1(x)\)</span> gives you a smaller
variance.</p>
<p>We can infer the reason for this result by graphing the function of
<span class="math inline">\(g(x),f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> in the same plot.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="co"># g(x)</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>f1_ing <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span> (x <span class="sc">-</span> <span class="dv">1</span>)) <span class="co"># f1(x)</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>f2_ing <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span> (x <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span> <span class="co"># f2(x)</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,f1_ing,<span class="at">col =</span> <span class="st">&#39;red&#39;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;y&#39;</span>,<span class="at">main =</span> <span class="st">&#39;Graph of three functions&#39;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,f2_ing,<span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,y,<span class="at">col =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="fu">c</span>(<span class="st">&#39;y&#39;</span>,<span class="st">&#39;f1&#39;</span>,<span class="st">&#39;f2&#39;</span>),<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>),<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>And graph the ratio of <span class="math inline">\(g(x)/f_1(x)\)</span> and <span class="math inline">\(g(x)/f_2(x)\)</span>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y <span class="sc">/</span> f2_ing,<span class="at">col =</span> <span class="st">&#39;blue&#39;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;ratio&#39;</span>,<span class="at">main =</span> <span class="st">&#39;Graph of g(x)/f(x)&#39;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,y <span class="sc">/</span> f1_ing, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="fu">c</span>(<span class="st">&#39;g(x)/f1(x)&#39;</span>,<span class="st">&#39;g(x)/f2(x)&#39;</span>),<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>),<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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NFoEaHoyBGiyCQFa4iIEaAaTCeafnggQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAhoAUDNeoxW5fZ+XL6oxdZmUInlWKzzjKk5IkufNZ7CA9LWY7SptHd081lUj3vrRQq+UI2N0HFfryqlLfKDFB5Qsx6jTce9FZB842S9iFi8R6x1ZFApX5nLS1ns2loqBqFbVtx8ZwN0+DO84whQmd2K151uN+yspQDl9h/EAFhjUHn94x4FMljE5Ptgydr51fBCgMCbRu72VkAFLx3SR2yJgOCrrTHmHISWAVSCGM3fZNsBXeHbzp20WXht8GesFRB6Uy283g5IoLFNl+4SW9ZaxApUC1LryVnih8yPNVQ7eMZKg7TjupJWD5Ijb6y3XWbcalKu8jFvDwuN7DVpsY6zfcJixxi0uopisx6jXaCpUeL2So5MlHsV62pqJC4CBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBAawfER4Id93MsZD5SawfEB035TlY0q9YOiI+Qfus82imAVg+oyuFnHkG1fkD2wfPBtXpAp/uvPSeUm1erB1Tc/GYf3BpYawfEB0j7zkk4q9YOKBfjoyOG6bUDii4CBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAH9ATvbt43qYmPaAAAAAElFTkSuQmCC" /><!-- --></p>
<p>It can be found that compared with <span class="math inline">\(g(x)/f_2(x)\)</span>, the curve of <span class="math inline">\(g(x)/f_1(x)\)</span> changes more gently, so the
ratio of <span class="math inline">\(g(x)/f_1(x)\)</span> is closer to
the constant than <span class="math inline">\(g(x)/f_2(x)\)</span>, so
the estimated variance is smaller.</p>
</div>
<div id="question-5.15" class="section level3">
<h3>Question 5.15</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-5.15" class="section level3">
<h3>Answer 5.15</h3>
<p>According to the meaning of the question, we choose importance
function <span class="math inline">\(f_3(x)=\frac{e^{-x}}{1-e^{-1}},0&lt;x&lt;1\)</span>
to conduct importance stratified sampling of function <span class="math inline">\(g(x)=\frac{e^{-x}}{1+x^2}\)</span> in five
segments in the interval <span class="math inline">\((0,1)\)</span>.</p>
<p>Therefore, we can get <span class="math display">\[\int_0^1
g(x)dx=\sum_{j=1}^5\int_{\frac{j-1}{5}}^{\frac{j}{5}}g_j(x)dx=\sum_{j=1}^5\int_{\frac{j-1}{5}}^{\frac{j}{5}}\frac{g_j(x)}{f_j(x)}f_j(x)dx\]</span></p>
<p>with <span class="math inline">\(g_j(x)=g(x)\)</span>,<span class="math inline">\(x\in(\frac{j-1}{5},\frac{j}{5}),j=1,2,3,4,5\)</span>
and <span class="math inline">\(g_j(x)=0\)</span> otherwise. And we
should make <span class="math inline">\(f_j(x)=5c_jf(x),\frac{j-1}{5}&lt;x&lt;\frac{j}{5},j=1,2,3,4,5\)</span>.</p>
<p>Let <span class="math inline">\(\int_{\frac{j-1}{5}}^{\frac{j}{5}}
f_j(x)dx=1\)</span>, we have</p>
<p><span class="math display">\[1/c_j=\int_{\frac{j-1}{5}}^{\frac{j}{5}}
5f(x)dx=\int_{\frac{j-1}{5}}^{\frac{j}{5}}
\frac{5e^{-x}}{1-e^{-1}}dx=\frac{5(e^{-{(j-1)/5}}-e^{-{j/5}})}{1-e^{-1}},j=1,2,3,4,5,\]</span>
<span class="math display">\[f_j(x)=5c_jf(x)=\frac{e^{-x}}{e^{-{(j-1)/5}}-e^{-{j/5}}},\frac{j-1}{5}&lt;x&lt;\frac{j}{5}\
for\ j=1,2,3,4,5.\]</span> <span class="math display">\[F_j(t) =
\int_{\frac{j-1}{5}}^t
\frac{e^{-x}}{e^{-{(j-1)/5}}-e^{-{j/5}}}dx=\frac{e^{-{(j-1)/5}}-e^{-{t}}}{e^{-{(j-1)/5}}-e^{-{j/5}}},\frac{j-1}{5}&lt;t&lt;\frac{j}{5}.\]</span>
Therefore, we can generate <span class="math inline">\(X_{ij}\sim
F_j\)</span> by making <span class="math inline">\(F_j(t) = U\)</span>
and getting <span class="math display">\[X_j=-log(e^{-{(j-1)/5}} -
(e^{-{(j-1)/5}}-e^{-{j/5}})U_j),U_j\sim U(0,1)\]</span></p>
<p>Then <span class="math display">\[\hat{\theta}_j=\frac{1}{m}\sum_{i=1}^m
\frac{g_j(X_{ij})}{f_j(X_{ij})}=\frac{1}{m}\sum_{i=1}^m
\frac{e^{-{(j-1)/5}}-e^{-{j/5}}}{1+X_{ij}^2},X_{ij}\sim F_j\]</span> and
<span class="math display">\[\hat{\theta}^{SI}=\sum_{j=1}^5
\hat{\theta}_j\]</span> with <span class="math display">\[Var(\hat{\theta}^{SI})=\sum_{j=1}^5
Var(\hat{\theta}_j)=\sum_{j=1}^5 \frac{\sigma_j^2}{m},\]</span> <span class="math display">\[\sigma_j^2=Var(\frac{g_j(X_j)}{f_j(X_j)}),X_j\sim
F_j.\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># numbers of layers</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span><span class="co"># total sampling</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> n <span class="sc">/</span> k <span class="co"># sampling number in each layer</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> theta_var <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span>(<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>j<span class="sc">/</span><span class="dv">5</span>))<span class="sc">*</span><span class="fu">runif</span>(m)) <span class="co"># generate xj~Fj</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> (<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>j<span class="sc">/</span><span class="dv">5</span>)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>) <span class="co"># calculate g(Xj)/fj(Xj)</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  theta_hat <span class="ot">&lt;-</span> theta_hat <span class="sc">+</span> <span class="fu">mean</span>(theta) <span class="co"># estimate theta</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  theta_var <span class="ot">&lt;-</span> theta_var <span class="sc">+</span> <span class="fu">var</span>(theta)<span class="sc">/</span>m <span class="co"># estimate varience of theta</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>theta_hat</span></code></pre></div>
<pre><code>## [1] 0.5246902</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>theta_var</span></code></pre></div>
<pre><code>## [1] 3.154865e-08</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>We can get the result <span class="math inline">\(\hat{\theta}^{SI}=0.5246902\)</span> and <span class="math inline">\(Var(\hat{\theta}^{SI})=3.154865e-08\)</span>. It
can be found that <span class="math inline">\(\hat{\theta}^{SI}\)</span>
is similar to <span class="math inline">\(\hat\theta= 0.5257801\)</span>
and <span class="math inline">\(Var(\hat{\theta}^{SI})\)</span> is
smaller than <span class="math inline">\(Var(\hat\theta)/n =
0.0970314/n=9.70314e-06\)</span>.</p>
</div>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
<p>HW4 is mainly used for hypothesis testing and confidence interval
calculation.</p>
<div id="question-6.4" class="section level3">
<h3>Question 6.4</h3>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a
random sample from a from a lognormal distribution with unknown
parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
</div>
<div id="answer-6.4" class="section level3">
<h3>Answer 6.4</h3>
<p>Since <span class="math inline">\(X_1,...,X_n\)</span> are a random
sample from a from a lognormal distribution, so we can assume that</p>
<p><span class="math display">\[lnX_i\sim N(\mu,\sigma^2),i.i.d\ for\
i=1,...,n.\]</span> and <span class="math inline">\(\mu\)</span> and
<span class="math inline">\(\sigma^2\)</span> are both unknown.</p>
<p>Therefore, we have <span class="math display">\[T =
\frac{\bar{lnX}-\mu}{s/\sqrt{n}}\sim t_{n-1}\]</span> with <span class="math inline">\(\bar{lnX}=\frac{1}{n}\sum_{i=1}^nlnX_i\)</span>
and <span class="math inline">\(s^2=\frac{1}{n-1}\sum_{i=1}^n(lnX_i-\bar{lnX})^2\)</span>,
<span class="math inline">\(t_{n-1}\)</span> is t distribution with
freedom <span class="math inline">\(n-1\)</span>.</p>
<p>So we have <span class="math inline">\(1-\alpha\)</span> confidence
interval for <span class="math inline">\(\mu\)</span> is</p>
<p><span class="math display">\[(\bar{lnX}-\frac{s}{\sqrt{n}}t_{1-\alpha/2}(n-1),\bar{lnX}+\frac{s}{\sqrt{n}}t_{1-\alpha/2}(n-1))\]</span></p>
<p>Make <span class="math inline">\(\alpha=0.05\)</span>, we have 95%
confidence interval for <span class="math inline">\(\mu\)</span> is</p>
<p><span class="math display">\[(\bar{lnX}-\frac{s}{\sqrt{n}}t_{0.975}(n-1),\bar{lnX}+\frac{s}{\sqrt{n}}t_{0.975}(n-1))\]</span></p>
<p>If we want to use MC method to obtain an empirical estimate of the
confidence level, we can repeat to general <span class="math inline">\(X_i,i=1,...,n\)</span> to <span class="math inline">\(m\)</span> times with distribution <span class="math inline">\(lnX_i\sim N(\mu_0,\sigma_0^2)\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate and save data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>sampling <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="fl">1e2</span>, <span class="at">m =</span> <span class="fl">1e3</span>, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>){</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n<span class="sc">*</span>m,<span class="at">mean =</span> mu, <span class="at">sd =</span> sigma) <span class="co"># generate normal random sample</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">exp</span>(y) <span class="co"># generate log normal sample from normal random sample</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x) <span class="co"># Clean up the memory</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>For each time <span class="math inline">\(k\)</span>, calculate
confidence intervel <span class="math inline">\((\hat\mu_{1k},\hat\mu_{2k})=(\bar{lnX}-\frac{s}{\sqrt{n}}t_{1-\alpha/2}(n-1),\bar{lnX}+\frac{s}{\sqrt{n}}t_{1-\alpha/2}(n-1))\)</span>
and determine whether <span class="math inline">\(\mu_0\)</span> is in
the above range, getting <span class="math inline">\(I(\mu_0\in
(\hat\mu_{1k},\hat\mu_{2k}))\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># analyzing data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>analyzing <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="fl">1e2</span>, <span class="at">m =</span> <span class="fl">1e3</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,<span class="at">mu =</span> mu){</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  x_all <span class="ot">&lt;-</span> <span class="fu">sampling</span>(n,m,mu,<span class="at">sigma=</span><span class="dv">1</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate confidence interval</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_all[((i<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="sc">*</span>n)]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">log</span>(x))<span class="sc">-</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(<span class="fu">log</span>(x)))<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">log</span>(x))<span class="sc">+</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(<span class="fu">log</span>(x)))<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    result[i] <span class="ot">&lt;-</span> (lower <span class="sc">&lt;</span> mu) <span class="sc">*</span> (upper <span class="sc">&gt;</span> mu) <span class="co"># judge whether mu in confidence interval</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  result</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Finally, get <span class="math inline">\(\hat{CP}=\frac{1}{m}\sum_{k=1}^m I(\mu_0\in
(\hat\mu_{1k},\hat\mu_{2k}))\)</span> as empirical estimate of the
confidence level.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># result and summary</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>showing <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="fl">1e2</span>, <span class="at">m =</span> <span class="fl">1e3</span>, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>){</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sampling</span>(<span class="at">n=</span>n,<span class="at">m=</span>m,<span class="at">mu =</span> mu)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">analyzing</span>(<span class="at">n=</span>n,<span class="at">m=</span>m,<span class="at">alpha =</span> alpha, <span class="at">mu =</span> mu)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">mean</span>(result))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can write it as follow R code with <span class="math inline">\(n=100\)</span> and <span class="math inline">\(m=1000\)</span> and test <span class="math inline">\(\mu_0=0,10\)</span> and <span class="math inline">\(100\)</span>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">showing</span>(<span class="at">n =</span> <span class="fl">1e2</span>, <span class="at">m =</span> <span class="fl">1e3</span>, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.948</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">showing</span>(<span class="at">n =</span> <span class="fl">1e2</span>, <span class="at">m =</span> <span class="fl">1e3</span>, <span class="at">mu =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.948</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">showing</span>(<span class="at">n =</span> <span class="fl">1e2</span>, <span class="at">m =</span> <span class="fl">1e3</span>, <span class="at">mu =</span> <span class="dv">100</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.945</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>All of empirical estimators of the confidence level is similar to
0.95.</p>
</div>
<div id="question-6.8" class="section level3">
<h3>Question 6.8</h3>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F
test of equal variance, at significance level <span class="math inline">\(\hat\alpha= 0.055\)</span>. Compare the power of
the Count Five test and F test for small, medium, and large sample
sizes. (Recall that the F test is not applicable for non-normal
distributions.)</p>
</div>
<div id="answer-6.8" class="section level3">
<h3>Answer 6.8</h3>
<p>For two sample <span class="math inline">\(X_1,...,X_{n_x} \sim F_x,
i.i.d.\)</span>, <span class="math inline">\(Y_1,...,Y_{n_y} \sim
F_y,i.i.d.\)</span> are independent, with <span class="math inline">\(var(X)=\sigma^2_x\)</span> and <span class="math inline">\(var(Y)=\sigma^2_y\)</span>. We want to test <span class="math display">\[H_0:\sigma^2_x=\sigma^2_y\ \ v.s.\ \
H_1:\sigma^2_x\neq\sigma^2_y\]</span> and we know that if <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> come from normal distribution, we
have under <span class="math inline">\(H_0\)</span>, <span class="math display">\[F=s_x^2/s_y^2\sim F(n_x-1,n_y-1)\]</span> where
<span class="math inline">\(s_x^2=\frac{1}{n_x-1}\sum_{i=1}^{n_x}(X_i-\bar{X})^2\)</span>,
<span class="math inline">\(s_y^2=\frac{1}{n_y-1}\sum_{i=1}^{n_y}(Y_i-\bar{Y})^2\)</span>
and <span class="math inline">\(\bar{X}=\frac{1}{n_x}\sum_{i=1}^{n_x}X_i\)</span>,
<span class="math inline">\(\bar{Y}=\frac{1}{n_y}\sum_{i=1}^{n_y}Y_i\)</span>.</p>
<p>Therefore, with Count Five Test estimator <span class="math inline">\(C=max(C_x,C_y)\)</span>, where <span class="math inline">\(C_x=\#\{i:|X_i-\bar X|&gt;max_j |Y_j-\bar
Y|\}\)</span> and <span class="math inline">\(C_y=\#\{i:|Y_i-\bar
Y|&gt;max_j |X_j-\bar X|\}\)</span>, we can estimate the power of the
Count Five test and F test at significance level <span class="math inline">\(\hat\alpha= 0.055\)</span>.</p>
<p>The power is calculated as the probability that the test statistic
falls into the rejection domain under <span class="math inline">\(H_1\)</span>. Let’s call the test statistic <span class="math inline">\(F\)</span> and the rejection field be <span class="math inline">\(C_F\)</span>, so we have <span class="math display">\[power=P_{H_1}(F\in C_F)\]</span></p>
<p>For Count Five Test, <span class="math inline">\(C_F=(5,+\infty)\)</span>. For F test, <span class="math inline">\(C_F=(0,F_{\alpha/2}(n_x-1,n_y-1))\cup(F_{1-\alpha/2}(n_x-1,n_y-1,+\infty))\)</span>.</p>
<p>Since the F-test is applicable to normally distributed data, we
generate two sets of random numbers that follow the normal
distribution.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate and save data</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>data_generate <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nx=</span><span class="dv">10</span>,<span class="at">ny=</span><span class="dv">10</span>,<span class="at">sigma1=</span><span class="dv">1</span>,<span class="at">sigma2=</span><span class="dv">2</span>,<span class="at">m=</span><span class="fl">1e3</span>){</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nx<span class="sc">*</span>m, <span class="dv">0</span>, sigma1)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(ny<span class="sc">*</span>m, <span class="dv">0</span>, sigma2)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Subsequently, the power calculation functions of count five test and
F-test were constructed respectively.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count5test statistic</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>power5test <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nx=</span><span class="dv">10</span>, <span class="at">ny=</span><span class="dv">10</span>,<span class="at">m=</span><span class="fl">1e3</span>,data){</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Import data</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  x_all <span class="ot">&lt;-</span> data<span class="sc">$</span>x</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  y_all <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_all[((i<span class="dv">-1</span>)<span class="sc">*</span>nx<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="sc">*</span>nx)]</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y_all[((i<span class="dv">-1</span>)<span class="sc">*</span>ny<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="sc">*</span>ny)]</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    result[i] <span class="ot">&lt;-</span> <span class="fu">count5test</span>(x, y) <span class="co"># count five test</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">mean</span>(result))</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count5test statistic</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>power5test <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nx=</span><span class="dv">10</span>, <span class="at">ny=</span><span class="dv">10</span>,<span class="at">m=</span><span class="fl">1e3</span>,data){</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Import data</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  x_all <span class="ot">&lt;-</span> data<span class="sc">$</span>x</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  y_all <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_all[((i<span class="dv">-1</span>)<span class="sc">*</span>nx<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="sc">*</span>nx)]</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y_all[((i<span class="dv">-1</span>)<span class="sc">*</span>ny<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="sc">*</span>ny)]</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    result[i] <span class="ot">&lt;-</span> <span class="fu">count5test</span>(x, y) <span class="co"># count five test</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">mean</span>(result))</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># F-test</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>powerFtest <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nx=</span><span class="dv">10</span>, <span class="at">ny=</span><span class="dv">10</span>,<span class="at">m=</span><span class="fl">1e3</span>,<span class="at">alpha =</span> <span class="fl">0.055</span>,data){</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Import data</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  x_all <span class="ot">&lt;-</span> data<span class="sc">$</span>x</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  y_all <span class="ot">&lt;-</span> data<span class="sc">$</span>y</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_all[((i<span class="dv">-1</span>)<span class="sc">*</span>nx<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="sc">*</span>nx)]</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y_all[((i<span class="dv">-1</span>)<span class="sc">*</span>ny<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="sc">*</span>ny)]</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine whether in the reject field</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    result[i] <span class="ot">&lt;-</span> </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span> <span class="sc">-</span> <span class="fu">as.integer</span>((<span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">var</span>(y) <span class="sc">&lt;</span> <span class="fu">qf</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,nx<span class="dv">-1</span>,ny<span class="dv">-1</span>))<span class="sc">*</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>                       (<span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">var</span>(y) <span class="sc">&gt;</span> <span class="fu">qf</span>(alpha<span class="sc">/</span><span class="dv">2</span>,nx<span class="dv">-1</span>,ny<span class="dv">-1</span>)))</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">mean</span>(result))</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Finally, output the calculation result.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># result and summary</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nx=</span><span class="dv">10</span>, <span class="at">ny=</span><span class="dv">10</span>,<span class="at">m=</span><span class="fl">1e3</span>,<span class="at">alpha =</span> <span class="fl">0.055</span>,<span class="at">sigma1=</span><span class="dv">1</span>,<span class="at">sigma2=</span><span class="dv">10</span>){</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data_generate</span>(<span class="at">nx=</span>nx, <span class="at">ny=</span>ny,<span class="at">sigma1=</span>sigma1,<span class="at">sigma2=</span>sigma2,<span class="at">m=</span>m)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Power of Count Five Test:&#39;</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">power5test</span>(<span class="at">nx=</span>nx, <span class="at">ny=</span>ny,<span class="at">m=</span>m,<span class="at">data=</span>data)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;Power of F Test:&#39;</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">powerFtest</span>(<span class="at">nx=</span>nx, <span class="at">ny=</span>ny,<span class="at">m=</span>m,<span class="at">alpha =</span> alpha,<span class="at">data=</span>data)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Power estimates were obtained by running <span class="math inline">\(m=1000\)</span> trials, generating two experiments
with mean <span class="math inline">\(\mu_x=\mu_y=0\)</span> and
variance <span class="math inline">\(\sigma_x=1,\sigma_y=1.5\)</span>
for each set of samples of small size <span class="math inline">\(n_x=n_y=20\)</span>, median size <span class="math inline">\(n_x=n_y=80\)</span> and large size <span class="math inline">\(n_x=n_y=200\)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">power</span>(<span class="at">nx=</span><span class="dv">20</span>, <span class="at">ny=</span><span class="dv">20</span>,<span class="at">sigma1=</span><span class="dv">1</span>,<span class="at">sigma2=</span><span class="fl">1.5</span>) <span class="co">#small size</span></span></code></pre></div>
<pre><code>## [1] &quot;Power of Count Five Test:&quot;
## [1] 0.306
## [1] &quot;Power of F Test:&quot;
## [1] 0.419</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power</span>(<span class="at">nx=</span><span class="dv">80</span>, <span class="at">ny=</span><span class="dv">80</span>,<span class="at">sigma1=</span><span class="dv">1</span>,<span class="at">sigma2=</span><span class="fl">1.5</span>) <span class="co">#median size</span></span></code></pre></div>
<pre><code>## [1] &quot;Power of Count Five Test:&quot;
## [1] 0.8
## [1] &quot;Power of F Test:&quot;
## [1] 0.954</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power</span>(<span class="at">nx=</span><span class="dv">200</span>, <span class="at">ny=</span><span class="dv">200</span>,<span class="at">sigma1=</span><span class="dv">1</span>,<span class="at">sigma2=</span><span class="fl">1.5</span>) <span class="co">#large size</span></span></code></pre></div>
<pre><code>## [1] &quot;Power of Count Five Test:&quot;
## [1] 0.955
## [1] &quot;Power of F Test:&quot;
## [1] 1</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>It can be found that the power both increased with the increase of
sample size under normal distribution random number, and the power of
F-test is slightly higher than that of count five test.</p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. Can we say the powers are different at 0.05 level?</p>
<p>(1)What is the corresponding hypothesis test problem?</p>
<p>(2)Which test can we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
<p>(3)Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<p>As the question shows, our goal is to determine whether two different
methods have the same power. Let the power of the first method be <span class="math inline">\(\beta_1\)</span> with an estimated value of <span class="math inline">\(\hat\beta_1=0.676\)</span> with <span class="math inline">\(n=10000\)</span> experiments, and the power of the
second method be <span class="math inline">\(\beta_2\)</span> with an
estimated value of <span class="math inline">\(\hat\beta_2=0.651\)</span> with the same <span class="math inline">\(n=10000\)</span> experiments. Therefore, we can
put forward the null hypothesis and alternative hypothesis as follows.
<span class="math display">\[H_0:\beta_1=\beta_2\ \ v.s.\ \
H_1:\beta_1\neq \beta_2\]</span></p>
<p>Assuming that the null hypothesis and alternative hypothesis of the
original test problem are <span class="math inline">\(H_{a0}\)</span>
and <span class="math inline">\(H_{a1}\)</span> respectively, we can
easily obtain the power calculation formula with significance level
<span class="math inline">\(\alpha\)</span> as</p>
<p><span class="math display">\[\beta=P(p-value&lt;\alpha|H_{a1})\]</span> Since
the distribution of the test statistic in the original problem is
unknown, it is difficult to determine the specific distribution of the
power function <span class="math inline">\(\beta\)</span> and the
details of the experiment, so t-test is not easily to use and we can
consider non-parametric statistical methods and z-test.</p>
<p>Since we know the total number of experiments <span class="math inline">\(n=10000\)</span>, and for each experiment, two
methods will be used to judge whether the corresponding test statistic
falls into the rejection domain, so as to obtain paired data samples and
we can consider the McNamer test with the least necessary information
for hypothesis testing.</p>
<p>Considering the point estimate <span class="math inline">\(\hat\beta_1=0.651,\hat\beta_2=0.676\)</span>, we
can know that method 1 has <span class="math inline">\(n\times
\beta_1=6510\)</span> rejections and <span class="math inline">\(n\times
(1-\beta_1)=3490\)</span> acceptances in the condition of H_a1 out of
10000 trials, For method 2, <span class="math inline">\(n\times
\beta_2=6760\)</span> rejections and <span class="math inline">\(n\times
(1-\beta_2)=3240\)</span> acceptances under the condition of <span class="math inline">\(H_{a1}\)</span>. Therefore, the contingency table
can be listed as follows.</p>
<table>
<thead>
<tr class="header">
<th>Method 1 \ Method 2</th>
<th>Reject</th>
<th>Accept</th>
<th>Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Reject</td>
<td><span class="math inline">\(x_{11}\)</span></td>
<td><span class="math inline">\(x_{12}\)</span></td>
<td>6510</td>
</tr>
<tr class="even">
<td>Accept</td>
<td><span class="math inline">\(x_{21}\)</span></td>
<td><span class="math inline">\(x_{22}\)</span></td>
<td>3490</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>6760</td>
<td>3240</td>
<td>10000</td>
</tr>
</tbody>
</table>
<p>And we can assume <span class="math inline">\(x_{11}=x\)</span> and
have,</p>
<table>
<thead>
<tr class="header">
<th>Method 1 \ Method 2</th>
<th>Reject</th>
<th>Accept</th>
<th>Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Reject</td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(6510-x\)</span></td>
<td>6510</td>
</tr>
<tr class="even">
<td>Accept</td>
<td><span class="math inline">\(6760-x\)</span></td>
<td><span class="math inline">\(x-3270\)</span></td>
<td>3490</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>6760</td>
<td>3240</td>
<td>10000</td>
</tr>
</tbody>
</table>
<p>So we construct McNamer test statistic,</p>
<p><span class="math display">\[\chi^2=\frac{(x_{12}-x_{21})^2}{x_{12}+x_{21}}=\frac{250^2}{13270-2x}\]</span>
Under <span class="math inline">\(H_0\)</span>, we have approximately
<span class="math inline">\(\chi^2\sim \chi_1^2\)</span>. Since <span class="math inline">\(x_{ij}\geq 0\)</span>, so we have the range of
<span class="math inline">\(x\)</span> is <span class="math inline">\(3270\leq x\leq 6510\)</span>, then <span class="math display">\[ 9.286776\approx\frac{250^2}{13270-2\times
3270}\leq \chi^2=\frac{250^2}{13270-2x} \leq \frac{250^2}{13270-2\times
6510}=250\]</span> Therefore, if <span class="math inline">\(\alpha=0.05\)</span>, we can easily have <span class="math display">\[\min_x \chi^2 &gt;
\chi^2_{1-\alpha}(1)=\chi^2_{0.95}(1)\approx3.841459\]</span> Therefore,
with <span class="math inline">\(\alpha=0.05\)</span> level, we can
reject <span class="math inline">\(H_0\)</span> and think <span class="math inline">\(\beta_1\neq\beta_2\)</span>, with the least
necessary information of <span class="math inline">\(n=10000\)</span>
and <span class="math inline">\(\hat\beta_1=0.651,\hat\beta_2=0.676\)</span>.</p>
<p>Besides, z test also can use. Considering <span class="math inline">\(\beta_j=\frac{1}{n}\sum_{i=1}^nI(T_{ij}\in
C_j),j=1,2\)</span> with <span class="math inline">\(T_{ij}\)</span> is
test statistic and <span class="math inline">\(C_j\)</span> is rejection
region. <span class="math inline">\(\beta_j\)</span> can be considered
as the proportion of the event that the test statistic falls into the
rejection domain, so the difference between the two proportions is
considered, and the normal approximation method is used to test.</p>
<p><span class="math display">\[Z=\frac{\beta_1-\beta_2-(\hat\beta_1-\hat\beta_2)}{\sqrt{\beta_1(1-\beta_1)/n_1+\beta_2(1-\beta_2)/n_2}}\approx\frac{\beta_1-\beta_2-(\hat\beta_1-\hat\beta_2)}{\sqrt{\hat\beta_1(1-\hat\beta_1)/n+\hat\beta_2(1-\hat\beta_2)/n}}\]</span></p>
<p>Under <span class="math inline">\(H_0\)</span>, we have approximately
<span class="math inline">\(Z\sim N(0,1)\)</span>, so by using <span class="math inline">\(n=10000\)</span> and <span class="math inline">\(\hat\beta_1=0.651,\hat\beta_2=0.676\)</span>, we
can calculate <span class="math display">\[|Z_0|=|\frac{\hat\beta_1-\hat\beta_2}{\sqrt{\hat\beta_1(1-\hat\beta_1)/n+\hat\beta_2(1-\hat\beta_2)/n}}|\approx
3.742519&gt;z_{1-\alpha/2}=z_{0.975}=1.959964\]</span> Therefore, we can
reject <span class="math inline">\(H_0\)</span> and think <span class="math inline">\(\beta_1\neq\beta_2\)</span>, with the least
necessary information of <span class="math inline">\(n=10000\)</span>
and <span class="math inline">\(\hat\beta_1=0.651,\hat\beta_2=0.676\)</span>.</p>
</div>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
<p>HW5 mainly tests the bootstrap method.</p>
</div>
<div id="question-7.4" class="section level2">
<h2>Question 7.4</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
air-conditioning equipment:</p>
<p><span class="math display">\[3, 5, 7, 18, 43, 85, 91, 98, 100, 130,
230, 487.\]</span></p>
<p>Assume that the times between failures follow an exponential model
<span class="math inline">\(Exp(\lambda)\)</span>. Obtain the MLE of the
hazard rate <span class="math inline">\(\lambda\)</span> and use
bootstrap to estimate the bias and standard error of the estimate.</p>
</div>
<div id="answer-7.4" class="section level2">
<h2>Answer 7.4</h2>
<p>According to the question, we can obtain the distribution <span class="math inline">\(Exp(\lambda)\)</span> which the failure time
interval <span class="math inline">\(X\)</span> follows, <span class="math inline">\(X\sim Exp(\lambda)\)</span>. So we have <span class="math display">\[f(x;\lambda)=\lambda e^{-\lambda
x},x&gt;0.\]</span> Likelihood function <span class="math inline">\(L(\lambda)=\prod_{i=1}^n f(x_i;\lambda)=\lambda^n
e^{-\lambda \sum_{i=1}^n x_i}\)</span> , <span class="math inline">\(lnL(\lambda)=ln\prod_{i=1}^n
f(x_i;\lambda)=nln\lambda -\lambda \sum_{i=1}^n x_i,x_i&gt;0\)</span>
for <span class="math inline">\(i=1,...,n\)</span>.</p>
<p><span class="math display">\[\frac{\partial lnL(\lambda)}{\partial
\lambda}=\frac{n}{\lambda}-\sum_{i=1}^n x_i=0\]</span> So <span class="math inline">\(\hat\lambda_{MLE}=\frac{n}{\sum_{i=1}^n
x_i}=1/\bar X\)</span>.</p>
<p>Therefore, we can calculate <span class="math inline">\(\hat\lambda_{MLE}\)</span> and use bootstrap to
estimate the bias and standard error of the estimate, with each
bootstrap estimator <span class="math inline">\(\hat\lambda^*_{(b)}\)</span> for <span class="math inline">\(b=1,...,B\)</span>.</p>
<p><span class="math display">\[\hat{bias}=E(\hat\lambda^*)-\hat\lambda_{MLE}=\bar\lambda^*-\hat\lambda_{MLE},\bar\lambda^*=\frac{1}{B}\sum_{i=1}^B\hat\lambda^*_{(b)}\]</span>
<span class="math display">\[sample\ standard\
error=\sqrt{\frac{1}{B-1}\sum_{i=1}^B(\hat\lambda^*_{(b)}-\bar\lambda^*)^2}\]</span></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot);</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get data</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>lambda_star <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> data,<span class="at">B =</span> B){</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    datastar <span class="ot">&lt;-</span> <span class="fu">sample</span>(data,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    lambda_star[b] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(datastar)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lambda_star) <span class="co">#save data</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate data</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>result_calculate <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> data,<span class="at">B=</span>B){</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  lambda_star <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(data,B)</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda_star) <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(data) <span class="co"># calculate bias</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  se_boot <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda_star) <span class="co"># calculate bias standard error</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">bias =</span> bias, <span class="at">se_boot =</span> se_boot)</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="co"># show the result</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>show_result <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> data,<span class="at">B =</span> B){</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">result_calculate</span>(data,B)</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#show</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">show_result</span>(data,B)</span></code></pre></div>
<pre><code>## $bias
## [1] 0.001360395
## 
## $se_boot
## [1] 0.004332554</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear memory</span></span></code></pre></div>
<p>Then we get the estimation of <span class="math inline">\(bias=0.001360395\)</span> and standard error is
<span class="math inline">\(0.004332554\)</span>.</p>
<div id="question-7.5" class="section level3">
<h3>Question 7.5</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
</div>
<div id="answer-7.5" class="section level3">
<h3>Answer 7.5</h3>
<p>For four 95% bootstrap confidence intervals estimation, we have for
mean time <span class="math inline">\(\theta=1/\lambda\)</span>,</p>
<ol style="list-style-type: decimal">
<li>Normal: <span class="math inline">\((\hat\theta−
z_{1−\alpha/2}\hat{se}(\hat\theta),
\hat\theta+z_{1−\alpha/2}\hat{se}(\hat\theta))\)</span>.</li>
<li>Basic: <span class="math inline">\((2\hat\theta−
\hat\theta^∗_{1−\alpha/2}, 2\hat\theta−
\hat\theta^∗_{\alpha/2})\)</span>.</li>
<li>Percent: <span class="math inline">\((\hat\theta^∗_{\alpha/2},\hat\theta^∗_{1−\alpha/2})\)</span>.</li>
<li>BCa: <span class="math inline">\((\hat\theta^∗_{\alpha_1},\hat\theta^∗_{\alpha_2})\)</span>,
<span class="math inline">\(\alpha_1,\alpha_2\)</span> are
adjusted.</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get data</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate function</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>boot_theta <span class="ot">&lt;-</span> <span class="cf">function</span>(datastar,i) <span class="fu">mean</span>(datastar[i])</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> data, <span class="at">statistic =</span> boot_theta,<span class="at">R =</span> B)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># analyse data</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(obj,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>CI_norm <span class="ot">&lt;-</span> CI<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>CI_basic <span class="ot">&lt;-</span> CI<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>CI_perc <span class="ot">&lt;-</span> CI<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>CI_bca <span class="ot">&lt;-</span> CI<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="co">#show the result</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;theta_hat=&#39;</span>,obj<span class="sc">$</span>t0)</span></code></pre></div>
<pre><code>## theta_hat= 108.0833</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;CI_norm = (&#39;</span>, CI_norm, <span class="st">&#39;)</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CI_basic = (&#39;</span>, CI_basic, <span class="st">&#39;)</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CI_perc = (&#39;</span>, CI_perc, <span class="st">&#39;)</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CI_bca = (&#39;</span>, CI_bca, <span class="st">&#39;)</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## CI_norm = ( 34.69875 182.2438 )
##  CI_basic = ( 24.33333 170.5 )
##  CI_perc = ( 45.66667 191.8333 )
##  CI_bca = ( 56.66667 232.3748 )</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
<p>As shown in the results, the confidence intervals estimated by the
four estimation methods are not the same, among which percentile depends
most on the actual bootstrap sampling value, while BCa can better modify
it. The Normal method relies on the normal approximation to estimate the
<span class="math inline">\(\theta\)</span> distribution and obtain the
confidence intervals, while basic estimates the confidence intervals
from the quantiles of the empirical distribution obtained by the
bootstrap sampling of <span class="math inline">\(\theta\)</span>.
Therefore, the confidence intervals obtained by these methods are
different.</p>
</div>
<div id="project-7.a" class="section level3">
<h3>Project 7.A</h3>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal population and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the proportion of times that the confidence
intervals miss on the right.</p>
</div>
<div id="answer-7.a" class="section level3">
<h3>Answer 7.A</h3>
<p>We can generate data <span class="math inline">\(n=20\)</span> from
standard normal distribution for each time, then make the three 95%
bootstrap confidence intervals estimation as,</p>
<ol style="list-style-type: decimal">
<li>Normal: <span class="math inline">\((\hat\theta−
z_{1−\alpha/2}\hat{se}(\hat\theta),
\hat\theta+z_{1−\alpha/2}\hat{se}(\hat\theta))\)</span>.</li>
<li>Basic: <span class="math inline">\((2\hat\theta−
\hat\theta^∗_{1−\alpha/2}, 2\hat\theta−
\hat\theta^∗_{\alpha/2})\)</span>.</li>
<li>Percent: <span class="math inline">\((\hat\theta^∗_{\alpha/2},\hat\theta^∗_{1−\alpha/2})\)</span>.</li>
</ol>
<p>Repeat this for <span class="math inline">\(B=1000\)</span> times and
we can obtain the estimate of <span class="math inline">\(B=1000\)</span> confidence intervals, and then
calculate the proportion of the true mean <span class="math inline">\(\mu_0=0\)</span> less than the left and greater
than the right boundary of the confidence interval respectively.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(datastar,i) <span class="fu">mean</span>(datastar[i])</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e3</span>;n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>CI_norm <span class="ot">&lt;-</span> CI_basic <span class="ot">&lt;-</span> CI_perc  <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,B,<span class="dv">2</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate data</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> data, <span class="at">statistic =</span> boot_mean,<span class="at">R =</span> B)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># analyse data</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  CI <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(obj,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  CI_norm[i,] <span class="ot">&lt;-</span> CI<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  CI_basic[i,] <span class="ot">&lt;-</span> CI<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  CI_perc[i,] <span class="ot">&lt;-</span> CI<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>coverage_norm <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(CI_norm[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">-</span><span class="fu">mean</span>(CI_norm[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">0</span>);</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>coverage_basic <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span>  <span class="fu">mean</span>(CI_basic[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">-</span><span class="fu">mean</span>(CI_basic[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">0</span>);</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>coverage_perc <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(CI_perc[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">-</span><span class="fu">mean</span>(CI_perc[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">0</span>);</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>left_miss_norm <span class="ot">&lt;-</span> <span class="fu">mean</span>(CI_norm[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>); right_miss_norm <span class="ot">&lt;-</span> <span class="fu">mean</span>(CI_norm[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">0</span>); </span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>left_miss_basic <span class="ot">&lt;-</span> <span class="fu">mean</span>(CI_basic[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>); right_miss_basic <span class="ot">&lt;-</span> <span class="fu">mean</span>(CI_basic[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">0</span>); </span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>left_miss_perc <span class="ot">&lt;-</span> <span class="fu">mean</span>(CI_perc[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>); right_miss_perc <span class="ot">&lt;-</span> <span class="fu">mean</span>(CI_perc[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">0</span>); </span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a><span class="co"># show result</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;left_miss_norm = &#39;</span>,left_miss_norm, <span class="st">&#39;right_miss_norm = &#39;</span>,right_miss_norm,<span class="st">&#39;coverage_norm = &#39;</span>,coverage_norm)</span></code></pre></div>
<pre><code>## left_miss_norm =  0.035 right_miss_norm =  0.042 coverage_norm =  0.923</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;left_miss_basic = &#39;</span>,left_miss_basic, <span class="st">&#39;right_miss_basic = &#39;</span>,right_miss_basic,<span class="st">&#39;coverage_basic = &#39;</span>,coverage_basic)</span></code></pre></div>
<pre><code>## left_miss_basic =  0.037 right_miss_basic =  0.044 coverage_basic =  0.919</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;left_miss_perc = &#39;</span>,left_miss_perc, <span class="st">&#39;right_miss_perc = &#39;</span>,right_miss_perc,<span class="st">&#39;coverage_perc = &#39;</span>,coverage_perc)</span></code></pre></div>
<pre><code>## left_miss_perc =  0.037 right_miss_perc =  0.037 coverage_perc =  0.926</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;method&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>),<span class="st">&quot;coverage probabilities&quot;</span><span class="ot">=</span><span class="fu">c</span>(coverage_norm,coverage_basic,coverage_perc),<span class="st">&quot;left miss proportion&quot;</span><span class="ot">=</span><span class="fu">c</span>(left_miss_norm,left_miss_basic,left_miss_perc),<span class="st">&quot;right miss proportion&quot;</span><span class="ot">=</span><span class="fu">c</span>(right_miss_norm,right_miss_basic,right_miss_perc)))</span></code></pre></div>
<table style="width:88%;">
<caption>Table continues below</caption>
<colgroup>
<col width="18%" />
<col width="34%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">method</th>
<th align="center">coverage.probabilities</th>
<th align="center">left.miss.proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">norm</td>
<td align="center">0.923</td>
<td align="center">0.035</td>
</tr>
<tr class="even">
<td align="center">basic</td>
<td align="center">0.919</td>
<td align="center">0.037</td>
</tr>
<tr class="odd">
<td align="center">percentile</td>
<td align="center">0.926</td>
<td align="center">0.037</td>
</tr>
</tbody>
</table>
<table style="width:33%;">
<colgroup>
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">right.miss.proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.042</td>
</tr>
<tr class="even">
<td align="center">0.044</td>
</tr>
<tr class="odd">
<td align="center">0.037</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># Clear memory</span></span></code></pre></div>
</div>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
<div id="question-7.8" class="section level3">
<h3>Question 7.8</h3>
<p>Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}=\frac{\hat\lambda_1}{\sum_{i=1}^5\hat\lambda_i}\)</span>
with <span class="math inline">\(\hat\lambda_1 &gt;...&gt;
\hat\lambda_5\)</span> be the eigenvalues of <span class="math inline">\(\Sigma\)</span>, where <span class="math inline">\(\hat\Sigma\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>.</p>
</div>
<div id="answer-7.8" class="section level3">
<h3>Answer 7.8</h3>
<p>According to the question, the jackknife estimation of bias can be
calculated by the following equation.</p>
<p><span class="math display">\[\hat{bias}_{jack}=(n-1)(\bar{\hat\theta_{(\cdot)}}-\hat\theta)\]</span></p>
<p>where <span class="math inline">\(\bar{\hat\theta_{(\cdot)}}=\frac{1}{n}\sum_{i=1}^n\hat\theta_{(i)}\)</span>
and <span class="math inline">\(\hat\theta_{(i)} =
\frac{\hat\lambda_1^{(i)}}{\sum_{j=1}^5\hat\lambda_j^{(i)}}\)</span>
calculate from the data without <span class="math inline">\(i\)</span>th
index number.</p>
<p>Then we also can calculate the jackknife estimation of standard error
by the following equation.</p>
<p><span class="math display">\[\hat{se}_{jack}=\sqrt{\frac{n-1}{n}\sum_{i=1}^n(\hat\theta_{(i)}-\bar{\hat\theta_{(\cdot)}})^2}.\]</span></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># read data</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  scor</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate jackknife estimate of theta</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>theta.jacknife <span class="ot">&lt;-</span> <span class="cf">function</span>(scor){</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(scor[,<span class="dv">1</span>])</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  theta_jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    lambda_jack <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">var</span>(scor[<span class="sc">-</span>i,]))<span class="sc">$</span>values</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    theta_jack[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda_jack) <span class="sc">/</span> <span class="fu">sum</span>(lambda_jack)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  theta_jack</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="co"># show the result</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>Result <span class="ot">&lt;-</span> <span class="cf">function</span>(scor,<span class="at">func =</span> theta.jacknife){</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(scor[,<span class="dv">1</span>])</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>  lambda_hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">var</span>(scor))<span class="sc">$</span>values</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>  theta_hat <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda_hat) <span class="sc">/</span> <span class="fu">sum</span>(lambda_hat) <span class="co"># calculate theta_hat</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  theta_jack <span class="ot">&lt;-</span> <span class="fu">func</span>(scor)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta_jack) <span class="sc">-</span> theta_hat)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta_jack <span class="sc">-</span> <span class="fu">mean</span>(theta_jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;bias =&#39;</span>,bias,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;standard error =&#39;</span>,se)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_data</span>()</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Result</span>(data,theta.jacknife)</span></code></pre></div>
<pre><code>## bias = 0.001069139 
## standard error = 0.04955231</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
<p>We have <span class="math inline">\(\hat{bias}_{jack}=
0.001069139\)</span>, <span class="math inline">\(\hat{se}_{jack}=0.04955231\)</span>.</p>
</div>
<div id="question-7.11" class="section level3">
<h3>Question 7.11</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
</div>
<div id="answer-7.11" class="section level3">
<h3>Answer 7.11</h3>
<p>According to the question, we need to use leave-two-out cross
validation to compare the models.</p>
<p>Therefore, we should take out two variables as the test set, and the
remaining variables as the training set, and find out the corresponding
model prediction and error. A total of <span class="math inline">\(C_n^2\)</span> model fitting was performed.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#get data</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  ironslag</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>leave_two_out_estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(ironslag){</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(ironslag[,<span class="dv">1</span>])</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> <span class="fu">c</span>(i,k)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>      y1 <span class="ot">&lt;-</span> ironslag[<span class="sc">-</span>j,]<span class="sc">$</span>magnetic</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>      x1 <span class="ot">&lt;-</span> ironslag[<span class="sc">-</span>j,]<span class="sc">$</span>chemical</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>      y2 <span class="ot">&lt;-</span> ironslag[j,]<span class="sc">$</span>magnetic</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>      x2 <span class="ot">&lt;-</span> ironslag[j,]<span class="sc">$</span>chemical</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Model 1</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>      J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y1<span class="sc">~</span>x1)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>      yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x2</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>      e1 <span class="ot">&lt;-</span> e1 <span class="sc">+</span> <span class="fu">mean</span>((y2 <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Model 2</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>      J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y1<span class="sc">~</span>x1<span class="sc">+</span><span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>      yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x2 <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> x2 <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>      e2 <span class="ot">&lt;-</span> e2 <span class="sc">+</span> <span class="fu">mean</span>((y2 <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Model 3</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>      J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y1)<span class="sc">~</span>x1)</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>      yhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x2</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>      e3 <span class="ot">&lt;-</span> e3 <span class="sc">+</span> <span class="fu">mean</span>((y2 <span class="sc">-</span> <span class="fu">exp</span>(yhat3))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Model 4</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>      J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y1)<span class="sc">~</span><span class="fu">log</span>(x1))</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>      yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(x2)</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>      e4 <span class="ot">&lt;-</span> e4 <span class="sc">+</span> <span class="fu">mean</span>((y2 <span class="sc">-</span> <span class="fu">exp</span>(yhat4))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(e1,e2,e3,e4) <span class="sc">*</span> <span class="dv">2</span><span class="sc">/</span> ((n<span class="dv">-1</span>)<span class="sc">*</span>n))</span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a><span class="co"># show result</span></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>Result <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>  ironslag <span class="ot">&lt;-</span> <span class="fu">get_data</span>()</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">leave_two_out_estimate</span>(ironslag)</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(result)</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Result</span>()</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
<p>We can see that for the four model, using leave-two-out cross
validation can get the prediction error <span class="math inline">\(19.57227,17.87018,18.45491\)</span> and <span class="math inline">\(20.46718\)</span>, respectively. So we can think
that the Model 2, the quadratic model, is better than others, and the
result is the same with leave-one-out (n-fold) cross validation.</p>
</div>
<div id="question-8.2" class="section level3">
<h3>Question 8.2</h3>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-8.2" class="section level3">
<h3>Answer 8.2</h3>
<p>For the test, <span class="math inline">\(H_0: X\ and\ Y\
independence\)</span> v.s. <span class="math inline">\(H_a: X\ and\ Y\
dependence\)</span>.</p>
<p>According to the question, we can first generate two groups of data
<span class="math inline">\(X=(X_1,...,X_n)&#39;\)</span> and <span class="math inline">\(Y=(Y_1,...,Y_n)&#39;\)</span>, and conduct
Spearman rank correlation test on them to obtain the Spearman rank
correlation coefficient estimation <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p>Then, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> were merged into matrix <span class="math inline">\(Z=(X,Y)\)</span>, and the new vector <span class="math inline">\(Y^*\)</span> was obtained by rearranging <span class="math inline">\(Y\)</span> in <span class="math inline">\(Z\)</span> with <span class="math inline">\(X\)</span> fixed for <span class="math inline">\(B\)</span> times. Spearman rank correlation test
was performed on <span class="math inline">\(X\)</span> and <span class="math inline">\(Y^*\)</span> to obtain the estimation of Spearman
rank correlation coefficient <span class="math inline">\(\hat\theta^{(b)}\)</span> for <span class="math inline">\(b=1,...,B\)</span>.</p>
<p>Finally, compute the ASL by <span class="math display">\[\hat
p=\frac{1+\sum_{b=1}^BI(|\hat\theta^{(b)}|\geq
\hat{\theta})}{B+1}.\]</span></p>
<p>If <span class="math inline">\(\hat p \leq \alpha\)</span>, reject
<span class="math inline">\(H_0\)</span>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># get data</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">dependence =</span> <span class="dv">1</span>){</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(dependence <span class="sc">==</span> <span class="dv">1</span>) y <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(dependence <span class="sc">==</span> <span class="dv">0</span>) y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>Spearman_permutation <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">B =</span> <span class="fl">1e3</span>, z){</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> z[,<span class="dv">1</span>];y <span class="ot">&lt;-</span> z[,<span class="dv">2</span>];</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); K <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  spearman0 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y,<span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)<span class="sc">$</span>estimate</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  spearman <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>K,n,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> z[,<span class="dv">1</span>];y1 <span class="ot">&lt;-</span> z[k,<span class="dv">2</span>]</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>    spearman[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x1,y1,<span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)<span class="sc">$</span>estimate</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(spearman0,spearman))<span class="sc">&gt;=</span><span class="fu">abs</span>(spearman0))</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Spearman_permutation p-value =&#39;</span>,p_value,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Spearman p-value =&#39;</span>,<span class="fu">cor.test</span>(x,y,<span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)<span class="sc">$</span>p.value,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>Result <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">dependence =</span> <span class="dv">1</span>,<span class="at">B =</span> <span class="fl">1e3</span>){</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">get_data</span>(n,dependence)</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Spearman_permutation</span>(B,z)</span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Result</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">dependence =</span> <span class="dv">1</span>,<span class="at">B =</span> <span class="fl">1e3</span>)</span></code></pre></div>
<pre><code>## Spearman_permutation p-value = 0.000999001 
## Spearman p-value = 0</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Result</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">dependence =</span> <span class="dv">0</span>,<span class="at">B =</span> <span class="fl">1e3</span>)</span></code></pre></div>
<pre><code>## Spearman_permutation p-value = 0.2507493 
## Spearman p-value = 0.2459676</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear memory</span></span></code></pre></div>
<p>By comparing, we can find that the p-value of achieved significance
level of the permutation test is similar to the p-value reported by
cor.test on the same samples.</p>
</div>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
<div id="question-9.4" class="section level3">
<h3>Question 9.4</h3>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain. Use the Gelman-Rubin method
to monitor convergence of the chain, and run the chain until it
converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt;1.2\)</span>.</p>
</div>
<div id="answer-9.4" class="section level3">
<h3>Answer 9.4</h3>
<p>The target distribution for generating random numbers by using random
walk Metropolis sampler is the standard Laplace distribution, and the
probability density function is as follows.</p>
<p><span class="math display">\[f(x)=\frac{1}{2}e^{-|x|},x\in
R.\]</span></p>
<p>Meanwhile, the normal distribution is used as the proposal
distribution, so random numbers <span class="math inline">\(Y|X_t\sim N
(X_t, \sigma^2)\)</span> are generated at step <span class="math inline">\(t+1\)</span> with the random number <span class="math inline">\(X_t\)</span> in step <span class="math inline">\(t\)</span>, and the acceptance probability is
calculated as,</p>
<p><span class="math display">\[\alpha(x_t,y)=\min\{1,f(y)/f(x_t)\}\]</span> And
then generate <span class="math inline">\(u\sim U(0,1)\)</span>, if
<span class="math inline">\(u\leq \alpha(x_t,y)\)</span>, let <span class="math inline">\(X_{t+1}=Y\)</span>, else <span class="math inline">\(X_{t+1}=X_t\)</span>.</p>
<p>In the process of chain generation, we can use the Gelman-Rubin
method to monitor convergence. By calculating,</p>
<p><span class="math display">\[\phi_{in}=\frac{1}{n}\sum_{j=1}^nX_{ij}\]</span>
where <span class="math inline">\(X_{ij}\)</span> is the <span class="math inline">\(j\)</span>th step generator in <span class="math inline">\(i\)</span>th chain, <span class="math inline">\(1\leq i\leq k,1\leq j \leq n\)</span>. Then
calculate <span class="math display">\[B_n=\frac{n}{k-1}\sum_{i=1}^k(\bar{\phi_{i\cdot}}-\bar{\phi_{\cdot\cdot}})^2,\]</span>
<span class="math display">\[W_n=\frac{1}{k}\sum_{i=1}^k\frac{1}{n}\sum_{i=1}^n({\phi_{ij}}-\bar{\phi_{i\cdot}})^2,\]</span>
<span class="math display">\[\hat{var}_n(\phi)=\frac{n}{n-1}W_n+\frac{1}{n}B_n,\]</span>
<span class="math display">\[\hat{R}_n=\frac{\hat{var}_n(\phi)}{W_n}.\]</span>
And if <span class="math inline">\(\hat{R}\geq 1.2\)</span>, we keep
adding samples <span class="math inline">\(n+1\)</span>, else if <span class="math inline">\(\hat{R}&lt; 1.2\)</span>, we think the chain
converges.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#generate data</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(Xt,sigma){</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,Xt,sigma)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  fy <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(Y))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  fx <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(Xt))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>,fy<span class="sc">/</span>fx) <span class="co">#Acceptance Probability</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(U<span class="sc">&lt;=</span>alpha) {<span class="fu">list</span>(<span class="at">X=</span>Y,<span class="at">accept=</span><span class="dv">1</span>)}</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">list</span>(<span class="at">X=</span>Xt,<span class="at">accept=</span><span class="dv">0</span>)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co"># one chain to converge</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>one_chain <span class="ot">&lt;-</span> <span class="cf">function</span>(X0,sigma){</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(X0)</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> phi <span class="ot">&lt;-</span> Y <span class="ot">&lt;-</span> acceptance_prob <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N<span class="sc">*</span>m)</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(X) <span class="ot">&lt;-</span> <span class="fu">dim</span>(phi) <span class="ot">&lt;-</span> <span class="fu">c</span>(N,m)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>  X[N,] <span class="ot">&lt;-</span> phi[N,] <span class="ot">&lt;-</span> X0</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(R<span class="sc">&gt;=</span><span class="fl">1.2</span>){</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(X[N,k],sigma)</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>      Y[k] <span class="ot">&lt;-</span> result<span class="sc">$</span>X</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>      acceptance_prob[k] <span class="ot">&lt;-</span> acceptance_prob[k] <span class="sc">+</span> result<span class="sc">$</span>accept</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(X,Y)</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>    phi <span class="ot">&lt;-</span> <span class="fu">rbind</span>(phi,<span class="fu">colMeans</span>(X))</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> N<span class="sc">/</span>(m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">colMeans</span>(phi)<span class="sc">-</span><span class="fu">mean</span>(phi))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>    W <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">t</span>(phi) <span class="sc">-</span> <span class="fu">colMeans</span>(phi))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>    var.hat <span class="ot">&lt;-</span> N<span class="sc">/</span>(N <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>W <span class="sc">+</span> B<span class="sc">/</span>N</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>    R <span class="ot">&lt;-</span> var.hat<span class="sc">/</span>W</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(phi[,<span class="dv">1</span>],<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="fu">bquote</span>(phi),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">max</span>(X0),<span class="fu">max</span>(X0)),<span class="at">col =</span> <span class="dv">2</span>,<span class="at">xlab =</span> <span class="fu">bquote</span>(sigma<span class="sc">==</span>.(sigma)))</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(phi[,k],<span class="at">col=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="at">legend =</span> X0,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span>m<span class="sc">+</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">title =</span> <span class="st">&#39;X0&#39;</span>)</span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">X=</span><span class="fu">rowMeans</span>(X),<span class="at">N=</span>N,<span class="at">acceptance_prob =</span> <span class="fu">mean</span>(acceptance_prob<span class="sc">/</span>(N<span class="dv">-1</span>)),<span class="at">R=</span>R,<span class="at">phi=</span>phi)</span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a><span class="co"># show result</span></span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a>show_result <span class="ot">&lt;-</span> <span class="cf">function</span>(X0,sigma){</span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> R <span class="ot">&lt;-</span> accept <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(sigma))</span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)){</span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true" tabindex="-1"></a>    result_X <span class="ot">&lt;-</span> <span class="fu">one_chain</span>(X0,sigma[k])</span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> result_X<span class="sc">$</span>X</span>
<span id="cb88-48"><a href="#cb88-48" aria-hidden="true" tabindex="-1"></a>    accept[k] <span class="ot">&lt;-</span> result_X<span class="sc">$</span>acceptance_prob</span>
<span id="cb88-49"><a href="#cb88-49" aria-hidden="true" tabindex="-1"></a>    N[k] <span class="ot">&lt;-</span> result_X<span class="sc">$</span>N</span>
<span id="cb88-50"><a href="#cb88-50" aria-hidden="true" tabindex="-1"></a>    R[k] <span class="ot">&lt;-</span> result_X<span class="sc">$</span>R</span>
<span id="cb88-51"><a href="#cb88-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(X,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;x&#39;</span>,<span class="at">xlab =</span> <span class="fu">bquote</span>(sigma<span class="sc">==</span>.(sigma[k])),<span class="at">main =</span> <span class="fu">bquote</span>(Acceptance_rate <span class="sc">==</span>.(accept[k])))</span>
<span id="cb88-52"><a href="#cb88-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-53"><a href="#cb88-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">accept=</span>accept,<span class="at">N=</span>N,<span class="at">R=</span>R)</span>
<span id="cb88-54"><a href="#cb88-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-55"><a href="#cb88-55" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb88-56"><a href="#cb88-56" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>);sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb88-57"><a href="#cb88-57" aria-hidden="true" tabindex="-1"></a>result_X_sigma <span class="ot">&lt;-</span> <span class="fu">show_result</span>(X0,sigma)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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kXGyNTUgfXfVdh3sfrqp7h/eXX1y9XEhP/z4OPmaGpAjkaosj6+rjwtZ4X9xH7QzLE6+JgdUZ1Cku7kt07D1cSEnfHH197t6LRsZJ19TA9KLQHopqB7T7erjQk74+qUN+816bJx8vSCgwq7RYwCtzDBZLKDuga4f8z5yauglplxuFjvFOpdK806OkYurzr9ksdhFuutk2/xOaNTpWf+mr1jwab7jcu3p5jasH3aBV72vokax1AvF+pfRcS93+rYu/fYgUx8XclTYjywj4+SKH1aBCAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgICWBujp24lvb0FaGKDnu6nv/0FaFqBCup7TfDQtClAht5PfYoc0Q0D7jzf1zUTJ530SUPXI/Af19IfHdCUB2ftg3+qtrXnkmL31kIAMguffpm+mIyALyLyiIl37gpofII1G3/XMKZZSsfqg6te/JCsJSKkv70Te8Cy2EBEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREND/ARN0xr0JLSy7AAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&#39;sigma&#39;</span><span class="ot">=</span>sigma,<span class="st">&#39;Acceptance_Probability&#39;</span><span class="ot">=</span>result_X_sigma<span class="sc">$</span>accept,<span class="st">&#39;N&#39;</span><span class="ot">=</span>result_X_sigma<span class="sc">$</span>N,<span class="st">&#39;R&#39;</span><span class="ot">=</span>result_X_sigma<span class="sc">$</span>R))</span></code></pre></div>
<table style="width:68%;">
<colgroup>
<col width="11%" />
<col width="34%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">sigma</th>
<th align="center">Acceptance_Probability</th>
<th align="center">N</th>
<th align="center">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.5</td>
<td align="center">0.8272</td>
<td align="center">15915</td>
<td align="center">1.2</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">0.7006</td>
<td align="center">8705</td>
<td align="center">1.2</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">0.2823</td>
<td align="center">606</td>
<td align="center">1.2</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="center">0.1533</td>
<td align="center">7764</td>
<td align="center">1.2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>By observing the trajectory images and acceptance ratio of chains
generated by different proposal distributions, it can be found that the
chain generated by the proposal distribution with smaller <span class="math inline">\(\sigma\)</span> does not converge, e.g.<span class="math inline">\(\sigma=0.5\)</span>, but the acceptance ratio is
higher, while the chain generated by the proposal distribution with
larger <span class="math inline">\(\sigma\)</span> converges well,
e.g.<span class="math inline">\(\sigma=1,5\)</span> and <span class="math inline">\(10\)</span>, but the acceptance ratio is lower.
Therefore, the larger <span class="math inline">\(\sigma\)</span> is,
the lower acceptance rates is. At the same time, the larger <span class="math inline">\(\sigma\)</span>, the smaller the number of steps
<span class="math inline">\(N\)</span> to achieve convergence, but if
the acceptance rate is lower, which will increase the number of steps
<span class="math inline">\(N\)</span> to achieve convergence.</p>
</div>
<div id="question-9.7" class="section level3">
<h3>Question 9.7</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = \beta_0 + \beta_1X\)</span> to the
sample and check the residuals of the model for normality and constant
variance.</p>
</div>
<div id="answer-9.7" class="section level3">
<h3>Answer 9.7</h3>
<p>Since we have <span class="math display">\[\left(\begin{array}{c}
X \\
Y \\
\end{array}
\right)\sim N(\left[\begin{array}{c}
\mu_x \\
\mu_y \\
\end{array}
\right],\left[\begin{array}{cc}
\sigma_{11} &amp; \sigma_{12} \\
\sigma_{21} &amp; \sigma_{22} \\
\end{array}
\right]) = N(\left[\begin{array}{c}
0 \\
0 \\
\end{array}
\right],\left[\begin{array}{cc}
1 &amp; 0.9 \\
0.9 &amp; 1 \\
\end{array}
\right])\]</span>, then we have</p>
<p><span class="math display">\[X|Y=y\sim
N(\mu_x+\sigma_{12}\sigma_{22}^{-1}(y-\mu_y),\sigma_{11}-\sigma_{12}\sigma_{22}^{-1}\sigma_{21})=N(0.9y,0.19)\]</span>
<span class="math display">\[Y|X=x\sim
N(\mu_y+\sigma_{21}\sigma_{11}^{-1}(x-\mu_x),\sigma_{22}-\sigma_{21}\sigma_{11}^{-1}\sigma_{12})=N(0.9x,0.19)\]</span>
Therefore, we can use Gibbs method to generate <span class="math inline">\((X,Y)\)</span> as above, and monitor the
convergence as Question 9.4.</p>
<p>Besides, we can consider the burn-in sample before convergence,
generate <span class="math inline">\(M=1e3\)</span> samples after <span class="math inline">\(N\)</span> and plot these.</p>
<p>And we can use shapiro.test() with <span class="math inline">\(H_0:normal\ residuals\)</span> to check the
residuals of the model for normality and Breusch-Pagan Test <span class="math inline">\(H_0:constant\ variance\)</span> to check constant
variance.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>gibbs_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(X0,Y0,<span class="at">M =</span> <span class="fl">1e3</span>){</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(X0)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(m <span class="sc">!=</span> <span class="fu">length</span>(Y0)){</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&#39;Wrong: length(X0) is not equal to length(Y0)!&#39;</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> phi_X <span class="ot">&lt;-</span> phi_Y <span class="ot">&lt;-</span> Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N<span class="sc">*</span>m)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>(X) <span class="ot">&lt;-</span> <span class="fu">dim</span>(Y) <span class="ot">&lt;-</span> <span class="fu">dim</span>(phi_X) <span class="ot">&lt;-</span> <span class="fu">dim</span>(phi_Y) <span class="ot">&lt;-</span> <span class="fu">c</span>(N,m)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> phi_X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> X0; Y[<span class="dv">1</span>,] <span class="ot">&lt;-</span> phi_Y[<span class="dv">1</span>,] <span class="ot">&lt;-</span> Y0</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>  RX <span class="ot">&lt;-</span> RY <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(RX<span class="sc">&gt;=</span><span class="fl">1.2</span><span class="sc">|</span>RY<span class="sc">&gt;=</span><span class="fl">1.2</span>){</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate data</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>    NX <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="fl">0.9</span><span class="sc">*</span>Y[N,],<span class="fu">sqrt</span>(<span class="fl">0.19</span>))</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(X,NX)</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    NY <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="fl">0.9</span><span class="sc">*</span>X[N<span class="sc">+</span><span class="dv">1</span>,],<span class="fu">sqrt</span>(<span class="fl">0.19</span>))</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Y,NY)</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate R_x and R_y</span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>    phi_X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(phi_X,<span class="fu">colMeans</span>(X))</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>    phi_Y <span class="ot">&lt;-</span> <span class="fu">rbind</span>(phi_Y,<span class="fu">colMeans</span>(Y))</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>    BX <span class="ot">&lt;-</span> N<span class="sc">/</span>(m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">colMeans</span>(phi_X)<span class="sc">-</span><span class="fu">mean</span>(phi_X))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>    WX <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">t</span>(phi_X) <span class="sc">-</span> <span class="fu">colMeans</span>(phi_X))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>    var.hat.X <span class="ot">&lt;-</span> N<span class="sc">/</span>(N <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>WX <span class="sc">+</span> BX<span class="sc">/</span>N</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>    RX <span class="ot">&lt;-</span> var.hat.X<span class="sc">/</span>WX</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>    BY <span class="ot">&lt;-</span> N<span class="sc">/</span>(m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">colMeans</span>(phi_Y)<span class="sc">-</span><span class="fu">mean</span>(phi_Y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>    WY <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">t</span>(phi_Y) <span class="sc">-</span> <span class="fu">colMeans</span>(phi_Y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>    var.hat.Y <span class="ot">&lt;-</span> N<span class="sc">/</span>(N <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>WY <span class="sc">+</span> BY<span class="sc">/</span>N</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>    RY <span class="ot">&lt;-</span> var.hat.Y<span class="sc">/</span>WY</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate data</span></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>    NX <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="fl">0.9</span><span class="sc">*</span>Y[N<span class="dv">-1</span><span class="sc">+</span>i,],<span class="fu">sqrt</span>(<span class="fl">0.19</span>))</span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(X,NX)</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>    NY <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="fl">0.9</span><span class="sc">*</span>X[N<span class="sc">+</span>i,],<span class="fu">sqrt</span>(<span class="fl">0.19</span>))</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Y,NY)</span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>    phi_X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(phi_X,<span class="fu">colMeans</span>(X))</span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>    phi_Y <span class="ot">&lt;-</span> <span class="fu">rbind</span>(phi_Y,<span class="fu">colMeans</span>(Y))</span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(phi_X[,<span class="dv">1</span>],<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="fu">bquote</span>(phi_X),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">max</span>(X0),<span class="fu">max</span>(X0)),<span class="at">col =</span> <span class="dv">2</span>,<span class="at">xlab =</span> <span class="st">&#39;plot for X&#39;</span>)</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(phi_X[,k],<span class="at">col=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="at">legend =</span> X0,<span class="at">col=</span>(<span class="dv">1</span><span class="sc">:</span>m)<span class="sc">+</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">title =</span> <span class="st">&#39;X0&#39;</span>)</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(phi_Y[,<span class="dv">1</span>],<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="fu">bquote</span>(phi_Y),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">max</span>(Y0),<span class="fu">max</span>(Y0)),<span class="at">col =</span> <span class="dv">2</span>,<span class="at">xlab =</span> <span class="st">&#39;plot for Y&#39;</span>)</span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(phi_Y[,k],<span class="at">col=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="at">legend =</span> Y0,<span class="at">col=</span>(<span class="dv">1</span><span class="sc">:</span>m)<span class="sc">+</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">title =</span> <span class="st">&#39;Y0&#39;</span>)</span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">X=</span><span class="fu">rowMeans</span>(X),<span class="at">Y=</span><span class="fu">rowMeans</span>(Y),<span class="at">N=</span>N,<span class="at">RX=</span>RX,<span class="at">phi_X=</span>phi_X,<span class="at">RY=</span>RY,<span class="at">phi_Y=</span>phi_Y)</span>
<span id="cb91-54"><a href="#cb91-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-55"><a href="#cb91-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;lmtest&#39;</span>)</span></code></pre></div>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show result</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>gibbs_result <span class="ot">&lt;-</span> <span class="cf">function</span>(X0,Y0,<span class="at">M=</span><span class="fl">1e3</span>){</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">gibbs_sample</span>(X0,Y0,M)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> result<span class="sc">$</span>X[(result<span class="sc">$</span>N<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(result<span class="sc">$</span>N<span class="sc">+</span>M)]</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> result<span class="sc">$</span>Y[(result<span class="sc">$</span>N<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(result<span class="sc">$</span>N<span class="sc">+</span>M)]</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(X,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;X&#39;</span>,<span class="at">main =</span> <span class="st">&#39;The chain of X after discarding&#39;</span>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(Y,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;Y&#39;</span>,<span class="at">main =</span> <span class="st">&#39;The chain of Y after discarding&#39;</span>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;N =&#39;</span>,result<span class="sc">$</span>N,<span class="st">&#39;</span><span class="sc">\t</span><span class="st">&#39;</span>,<span class="st">&#39;RX =&#39;</span>,result<span class="sc">$</span>RX,<span class="st">&#39;</span><span class="sc">\t</span><span class="st">&#39;</span>,<span class="st">&#39;RY =&#39;</span>,result<span class="sc">$</span>RY,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  lm.YX <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Fitted linear model:&#39;</span>,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(lm.YX))</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test normality</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,<span class="st">&#39;Test normality:&#39;</span>,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">shapiro.test</span>(lm.YX<span class="sc">$</span>residuals))</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Breusch-Pagan Test</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,<span class="st">&#39;Breusch-Pagan Test:&#39;</span>,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">bptest</span>(lm.YX))</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">5</span>);Y0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="fu">gibbs_result</span>(X0,Y0,<span class="at">M=</span><span class="fl">1e3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## N = 2385      RX = 1.199959   RY = 1.176104 
## Fitted linear model: 
## 
## Call:
## lm(formula = Y ~ X)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.65156 -0.13453  0.00751  0.13330  0.54759 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.002166   0.006307  -0.343    0.731    
## X            0.885664   0.013811  64.128   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.199 on 998 degrees of freedom
## Multiple R-squared:  0.8047, Adjusted R-squared:  0.8045 
## F-statistic:  4112 on 1 and 998 DF,  p-value: &lt; 2.2e-16
## 
## 
##  Test normality: 
## 
##  Shapiro-Wilk normality test
## 
## data:  lm.YX$residuals
## W = 0.99844, p-value = 0.5189
## 
## 
##  Breusch-Pagan Test: 
## 
##  studentized Breusch-Pagan test
## 
## data:  lm.YX
## BP = 0.97909, df = 1, p-value = 0.3224</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>See the result we have the fitted model significantly with <span class="math inline">\(\beta_1=0.885664\)</span>.</p>
<p>And see both of two test have <span class="math inline">\(p-value&gt;0.05\)</span>, so we can not reject
<span class="math inline">\(H_0\)</span>, which means we can think a
simple linear regression model <span class="math inline">\(Y = \beta_0 +
\beta_1X\)</span> fitted by the sample have the normal residuals and
constant variance.</p>
</div>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<p>Test the mediating effect M of the following model. <span class="math display">\[H_0:\alpha\beta=0\quad vs.\quad
H_1:\alpha\beta\neq0\]</span></p>
<p><span class="math display">\[M=a_M+\alpha X+e_M\]</span> <span class="math display">\[Y=a_Y+\beta M+\gamma X+e_Y\]</span> with <span class="math inline">\(e_M,e_Y\sim N(0,1)\)</span>.</p>
<p>Use permutation to examine three scenarios with <span class="math inline">\(\gamma=1\)</span> in three permutation
Conditions.</p>
<p>(1)<span class="math inline">\(\alpha=0,\beta=0\)</span>;</p>
<p>(2)<span class="math inline">\(\alpha=0,\beta=1\)</span>;</p>
<p>(3)<span class="math inline">\(\alpha=1,\beta=0\)</span>.</p>
<p>Condition 1. <span class="math inline">\(X\bot M\)</span>, which
permutate the index of <span class="math inline">\(X\)</span>;</p>
<p>Condition 2. <span class="math inline">\(M\bot Y\)</span>, which
permutate the index of <span class="math inline">\(Y\)</span>;</p>
<p>Condition 3. <span class="math inline">\(X\bot M\)</span> and <span class="math inline">\(M\bot Y\)</span>, which permutate the index of
<span class="math inline">\(M\)</span>.</p>
</div>
<div id="answer-1-1" class="section level3">
<h3>Answer 1</h3>
<p>First, we can generate data. Let’s say <span class="math inline">\(a_M=a_Y=0\)</span> and <span class="math inline">\(X\)</span> follows the standard normal
distribution, then <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> can be generated in turn according to
the values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">N=</span><span class="fl">1e3</span>,alpha,beta,<span class="at">gamma_x=</span><span class="dv">1</span>){</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  am <span class="ot">&lt;-</span> ay <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> am <span class="sc">+</span> alpha<span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> ay <span class="sc">+</span> beta<span class="sc">*</span>M <span class="sc">+</span> gamma_x<span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  data_XYM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X,<span class="at">M=</span>M,<span class="at">Y=</span>Y)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data_XYM)</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The value of <span class="math inline">\(M\)</span> was then replaced
using the permutation method, in which the mediation library could be
used to examine the mediation effect. Finally, the following formula is
used to calculate the p-value, with for <span class="math inline">\(i\)</span>th times <span class="math inline">\(|T_i|=|\frac{\hat\alpha\hat\beta}{se(\hat\alpha\hat\beta)}|\geq
|T_0|\)</span> equal to <span class="math inline">\(p_i\leq
p_0\)</span>. <span class="math display">\[p-value=\frac{1+\#\{p_i\leq
p_0\}}{B+1}\]</span></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mediation)</span></code></pre></div>
<pre><code>## Warning: package &#39;mediation&#39; was built under R version 4.2.2</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Warning: package &#39;sandwich&#39; was built under R version 4.2.2</code></pre>
<pre><code>## mediation: Causal Mediation Analysis
## Version: 4.5.0</code></pre>
<pre><code>## 
## Attaching package: &#39;mediation&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     jobs</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation get p-value</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Condition 1</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>Permutation_pvalue1 <span class="ot">&lt;-</span> <span class="cf">function</span>(data_XYM){</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  Tn_med <span class="ot">&lt;-</span> <span class="cf">function</span>(data_XYM,ix){</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>data_XYM<span class="sc">$</span>X[ix],<span class="at">M=</span>data_XYM<span class="sc">$</span>M,<span class="at">Y=</span>data_XYM<span class="sc">$</span>Y)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>    model.m <span class="ot">&lt;-</span> <span class="fu">lm</span>(M <span class="sc">~</span> X, <span class="at">data =</span> data)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>    model.y <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X, <span class="at">data =</span> data)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    out<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">mediate</span>(model.m, model.y, <span class="at">sims =</span> <span class="dv">100</span>, <span class="at">treat =</span> <span class="st">&quot;X&quot;</span>,<span class="at">mediator =</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out<span class="fl">.1</span><span class="sc">$</span>d.avg.p)</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  boot.med <span class="ot">&lt;-</span> <span class="fu">boot</span>(data_XYM,Tn_med,<span class="at">R=</span><span class="fl">1e2</span>,<span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>) </span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  ps <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.med<span class="sc">$</span>t0,boot.med<span class="sc">$</span>t)</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ps<span class="sc">&lt;=</span>ps[<span class="dv">1</span>])</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p.value)</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Condition 2</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>Permutation_pvalue2 <span class="ot">&lt;-</span> <span class="cf">function</span>(data_XYM){</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>  Tn_med <span class="ot">&lt;-</span> <span class="cf">function</span>(data_XYM,ix){</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>data_XYM<span class="sc">$</span>X,<span class="at">M=</span>data_XYM<span class="sc">$</span>M,<span class="at">Y=</span>data_XYM<span class="sc">$</span>Y[ix])</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>    model.m <span class="ot">&lt;-</span> <span class="fu">lm</span>(M <span class="sc">~</span> X, <span class="at">data =</span> data)</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>    model.y <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X, <span class="at">data =</span> data)</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>    out<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">mediate</span>(model.m, model.y, <span class="at">sims =</span> <span class="dv">100</span>, <span class="at">treat =</span> <span class="st">&quot;X&quot;</span>,<span class="at">mediator =</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out<span class="fl">.1</span><span class="sc">$</span>d.avg.p)</span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>  boot.med <span class="ot">&lt;-</span> <span class="fu">boot</span>(data_XYM,Tn_med,<span class="at">R=</span><span class="fl">1e2</span>,<span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>) </span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>  ps <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.med<span class="sc">$</span>t0,boot.med<span class="sc">$</span>t)</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ps<span class="sc">&lt;=</span>ps[<span class="dv">1</span>])</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p.value)</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Condition 3</span></span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>Permutation_pvalue3 <span class="ot">&lt;-</span> <span class="cf">function</span>(data_XYM){</span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>  Tn_med <span class="ot">&lt;-</span> <span class="cf">function</span>(data_XYM,ix){</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>data_XYM<span class="sc">$</span>X,<span class="at">M=</span>data_XYM<span class="sc">$</span>M[ix],<span class="at">Y=</span>data_XYM<span class="sc">$</span>Y)</span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a>    model.m <span class="ot">&lt;-</span> <span class="fu">lm</span>(M <span class="sc">~</span> X, <span class="at">data =</span> data)</span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a>    model.y <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X, <span class="at">data =</span> data)</span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a>    out<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">mediate</span>(model.m, model.y, <span class="at">sims =</span> <span class="dv">100</span>, <span class="at">treat =</span> <span class="st">&quot;X&quot;</span>,<span class="at">mediator =</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out<span class="fl">.1</span><span class="sc">$</span>d.avg.p)</span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a>  boot.med <span class="ot">&lt;-</span> <span class="fu">boot</span>(data_XYM,Tn_med,<span class="at">R=</span><span class="fl">1e2</span>,<span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>) </span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a>  ps <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.med<span class="sc">$</span>t0,boot.med<span class="sc">$</span>t)</span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ps<span class="sc">&lt;=</span>ps[<span class="dv">1</span>])</span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p.value)</span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And we can get the estimated p-value for three case as follow, all of
p-value is higer than <span class="math inline">\(0.05\)</span>, which
means all of case doesn’t have mediation effect. However, at the same
time, it can be found that under the first permutation, there is a
larger p value, that is, it can be closer to the real case.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e2</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>gamma_x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>p_value1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(alpha))</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>p_value2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(alpha))</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>p_value3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(alpha))</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(alpha)){</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  data_XYM <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(N,alpha[i],beta[i],gamma_x)</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  p_value1[i] <span class="ot">&lt;-</span> <span class="fu">Permutation_pvalue1</span>(data_XYM)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  p_value2[i] <span class="ot">&lt;-</span> <span class="fu">Permutation_pvalue2</span>(data_XYM)</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>  p_value3[i] <span class="ot">&lt;-</span> <span class="fu">Permutation_pvalue3</span>(data_XYM)</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;alpha&quot;</span><span class="ot">=</span>alpha,<span class="st">&quot;beta&quot;</span><span class="ot">=</span>beta,<span class="st">&quot;Condition1&quot;</span><span class="ot">=</span>p_value1,<span class="st">&quot;Condition2&quot;</span><span class="ot">=</span>p_value2,<span class="st">&quot;Condition3&quot;</span><span class="ot">=</span>p_value3))</span></code></pre></div>
<table style="width:75%;">
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">alpha</th>
<th align="center">beta</th>
<th align="center">Condition1</th>
<th align="center">Condition2</th>
<th align="center">Condition3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0.8713</td>
<td align="center">0.8614</td>
<td align="center">0.9802</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0.5644</td>
<td align="center">0.4257</td>
<td align="center">0.1584</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0.8218</td>
<td align="center">0.7525</td>
<td align="center">0.3861</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<p>Considering model <span class="math inline">\(P(Y=1|X_1,X_2,X_3)=expit(\alpha+b_1X_1+b_2X_2+b_3X_3)\)</span>
for <span class="math inline">\(X_1\sim Poisson(1),X_2\sim
Exp(1),X_3\sim B(1,0.5)\)</span>, answer the question</p>
<p>(1)Write a R function to complete the input are <span class="math inline">\(N,b_1,b_2,b_3,f_0\)</span> with output <span class="math inline">\(\alpha\)</span>.</p>
<p>(2)Use the R function with the input are <span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001\)</span>.</p>
<p>(3)Plot a scatter plot of <span class="math inline">\(f_0\)</span>
and <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="answer-2" class="section level3">
<h3>Answer 2</h3>
<p>Since <span class="math inline">\(P(Y=1|X_1,X_2,X_3)=expit(\alpha+b_1X_1+b_2X_2+b_3X_3)=exp(\alpha+b_1X_1+b_2X_2+b_3X_3)/(1+exp(\alpha+b_1X_1+b_2X_2+b_3X_3))\)</span>
and <span class="math inline">\(f_0=P(Y=1)=E(P(Y=1|X_1,X_2,X_3))\)</span>, we can
generate <span class="math inline">\((X_1,X_2,X_3)\)</span> for <span class="math inline">\(N\)</span> times to estimate <span class="math inline">\(\hat P(Y=1)\)</span>, and then solve <span class="math inline">\(g(\alpha)=\hat P(Y=1)-f_0=0\)</span> to get the
output <span class="math inline">\(\alpha\)</span>.</p>
<p>Then we can write the R function to accomplish above purpose.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co"># solve function</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>Find_alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">N=</span><span class="fl">1e6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">f0=</span><span class="fl">0.1</span>){</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>);x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N);</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  G <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>    P <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3))</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(P) <span class="sc">-</span> f0)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(G,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">0</span>))</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return alpha</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Consequently, we can use the above function to input <span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001\)</span>
and get the output of <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input N,b1,b2,b3,f0</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">0</span>;b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(f0)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co"># output alpha</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  alpha[i] <span class="ot">&lt;-</span> <span class="fu">Find_alpha</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(alpha,f0)</span></code></pre></div>
<pre><code>##           alpha    f0
## [1,]  -3.169890 1e-01
## [2,]  -6.073955 1e-02
## [3,]  -8.715274 1e-03
## [4,] -11.270168 1e-04</code></pre>
<p>Finally, plot the scatter plot of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(f_0\)</span>.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(alpha,<span class="fu">log</span>(f0),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">0</span>),<span class="at">main =</span> <span class="st">&#39;Scatter plot of f0 vs. alpha&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw9" class="section level2">
<h2>HW9</h2>
<div id="homework-after-class" class="section level3">
<h3>Homework after class</h3>
<p><span class="math inline">\(X_1,...,X_n\sim Exp(\lambda)\quad
i.i.d\)</span>, and we only know <span class="math inline">\(X_i\in
(u_i,v_i),u_i&lt;v_i\)</span> and <span class="math inline">\(u_i,v_i\)</span> is known.</p>
<ol style="list-style-type: decimal">
<li><p>Try to directly maximize the likelihood function of observation
data and use EM algorithm to solve the MLE of <span class="math inline">\(\lambda\)</span> respectively, and prove that the
two are equal.</p></li>
<li><p>Let the observed values of <span class="math inline">\((u_i,
v_i),i=1,...,10\)</span> be (11,12), (8,9), (27,28), (13,14), (16,17),
(0,1), (23, 24), (10,11), (24,25), (2,3), Try programming the above two
algorithms separately to get a numerical solution to <span class="math inline">\(\lambda\)</span>’s MLE.</p></li>
</ol>
</div>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<div id="section" class="section level4">
<h4>(1)</h4>
<p>Since <span class="math inline">\(X_1,...,X_n\sim Exp(\lambda)\quad
i.i.d\)</span>, we have the pdf of <span class="math inline">\(X_i\)</span> is <span class="math inline">\(f(x)=\lambda e^{-\lambda x},x&gt;0\)</span>.
Therefore, we have</p>
<p><span class="math display">\[P(X_i\in
(u_i,v_i))=\int_{u_i}^{v_i}\lambda e^{-\lambda x}dx=e^{-\lambda
u_i}-e^{-\lambda v_i}\]</span> and the likelihood of observed data</p>
<p><span class="math display">\[L(\lambda)=\prod_{i=1}^nP(X_i\in
(u_i,v_i))=\prod_{i=1}^n(e^{-\lambda u_i}-e^{-\lambda v_i})\]</span></p>
<p><span class="math display">\[l(\lambda)=\log
L(\lambda)=\sum_{i=1}^n\log(e^{-\lambda u_i}-e^{-\lambda v_i})\]</span>
And make the score function <span class="math inline">\(S(\lambda)=0\)</span> to solve <span class="math inline">\(\lambda\)</span>’s MLE for</p>
<p><span class="math display">\[S(\lambda)=\frac{d\log
L(\lambda)}{d\lambda}=\sum_{i=1}^n\frac{-u_ie^{-\lambda
u_i}+v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}.\]</span></p>
<p>For EM algorithm, we have the likelihood of completed data,</p>
<p><span class="math display">\[L_c(\lambda)=\prod_{i=1}^n \lambda
e^{-\lambda X_i}=\lambda^n e^{-\lambda \sum_{i=1}^n X_i}\]</span></p>
<p><span class="math display">\[l_c(\lambda)=\log L_c(\lambda)=n\log
\lambda-\lambda \sum_{i=1}^n X_i\]</span> <span class="math display">\[E_{\lambda_t}(\log L_c(\lambda)|X_i\in
(u_i,v_i))=n\log \lambda-\lambda \sum_{i=1}^n E_{\lambda_t}(X_i|X_i\in
(u_i,v_i))\]</span> with <span class="math display">\[E_{\lambda_t}(X_i|X_i\in
(u_i,v_i))=\int_{u_i}^{v_i}\frac{\lambda_t xe^{-\lambda_t x}}{P(X_i\in
(u_i,v_i))}dx=\int_{u_i}^{v_i}\frac{\lambda_t xe^{-\lambda_t
x}}{e^{-\lambda_t u_i}-e^{-\lambda_t v_i}}dx=\frac{u_ie^{-\lambda_t
u_i}-v_ie^{-\lambda_t v_i}}{e^{-\lambda_t u_i}-e^{-\lambda_t
v_i}}+1/\lambda_t\]</span></p>
<p>And make <span class="math inline">\(\frac{\partial
E_{\lambda_t}(\log L_c(\lambda)|X_i\in (u_i,v_i))}{\partial
\lambda}=0\)</span> to get <span class="math inline">\(\lambda_{t+1}\)</span> for</p>
<p><span class="math display">\[\frac{\partial E_{\lambda_t}(\log
L_c(\lambda)|X_i\in (u_i,v_i))}{\partial
\lambda}=\frac{n}{\lambda}-\sum_{i=1}^n (\frac{u_ie^{-\lambda_t
u_i}-v_ie^{-\lambda_t v_i}}{e^{-\lambda_t u_i}-e^{-\lambda_t
v_i}}+1/\lambda_t)\]</span> <span class="math display">\[\lambda_{t+1}=\frac{n}{\sum_{i=1}^n
(\frac{u_ie^{-\lambda_t u_i}-v_ie^{-\lambda_t v_i}}{e^{-\lambda_t
u_i}-e^{-\lambda_t v_i}}+1/\lambda_t)}\]</span> Therefore, we have</p>
<p><span class="math display">\[\lambda_{t+1}-\lambda_{t}=\frac{n}{\sum_{i=1}^n
(\frac{u_ie^{-\lambda_t u_i}-v_ie^{-\lambda_t v_i}}{e^{-\lambda_t
u_i}-e^{-\lambda_t v_i}}+1/\lambda_t)}-\frac{n}{\sum_{i=1}^n
(\frac{u_ie^{-\lambda_{t-1} u_i}-v_ie^{-\lambda_{t-1}
v_i}}{e^{-\lambda_{t-1} u_i}-e^{-\lambda_{t-1}
v_i}}+1/\lambda_{t-1})}=\frac{\lambda_t}{\frac{\lambda_t}{n}\sum_{i=1}^n
\frac{u_ie^{-\lambda_t u_i}-v_ie^{-\lambda_t v_i}}{e^{-\lambda_t
u_i}-e^{-\lambda_t
v_i}}+1}-\frac{\lambda_{t-1}}{\frac{\lambda_{t-1}}{n}\sum_{i=1}^n
\frac{u_ie^{-\lambda_{t-1} u_i}-v_ie^{-\lambda_{t-1}
v_i}}{e^{-\lambda_{t-1} u_i}-e^{-\lambda_{t-1} v_i}}+1}\]</span> We have
<span class="math display">\[\frac{\lambda_{t-1}}{n}\sum_{i=1}^n
\frac{u_ie^{-\lambda_{t-1} u_i}-v_ie^{-\lambda_{t-1}
v_i}}{e^{-\lambda_{t-1} u_i}-e^{-\lambda_{t-1} v_i}}&gt;0\]</span> <span class="math display">\[\frac{\lambda_{t-1}}{n}\sum_{i=1}^n
\frac{u_ie^{-\lambda_{t-1} u_i}-v_ie^{-\lambda_{t-1}
v_i}}{e^{-\lambda_{t-1} u_i}-e^{-\lambda_{t-1} v_i}}+1&gt;1\]</span>
<span class="math display">\[\frac{1}{\frac{\lambda_{t-1}}{n}\sum_{i=1}^n
\frac{u_ie^{-\lambda_{t-1} u_i}-v_ie^{-\lambda_{t-1}
v_i}}{e^{-\lambda_{t-1} u_i}-e^{-\lambda_{t-1} v_i}}+1}&lt;1\]</span>
when <span class="math inline">\(\lambda_t\)</span> is not convergence
and <span class="math inline">\(\lambda_t\)</span> varies monotonically
according to <span class="math inline">\(\lambda_{t-1}\)</span>,
besides, it is near 1 when converge.</p>
<p>Therefore, we have <span class="math display">\[|\lambda_{t+1}-\lambda_{t}|&lt;\alpha|\lambda_{t}-\lambda_{t-1}|\]</span>
<span class="math display">\[|\lambda_{t+1}-\lambda_{t}|&lt;\alpha^t|\lambda_{1}-\lambda_{0}|\]</span>
and <span class="math inline">\(\alpha&lt;1\)</span>, so <span class="math inline">\(\lambda_t\)</span> is convergence to <span class="math inline">\(\lambda&gt;0\)</span>.</p>
<p>Then since <span class="math inline">\(\lambda_t\)</span> is
convergence to <span class="math inline">\(\lambda&gt;0\)</span>, we
have</p>
<p><span class="math display">\[\lambda=\frac{n}{\sum_{i=1}^n
(\frac{u_ie^{-\lambda u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda
u_i}-e^{-\lambda v_i}}+1/\lambda)}\]</span> which is equal to</p>
<p><span class="math display">\[n=\lambda\sum_{i=1}^n
\frac{u_ie^{-\lambda u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda
u_i}-e^{-\lambda v_i}}+n\]</span> <span class="math display">\[\lambda\sum_{i=1}^n \frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}=0\]</span>
<span class="math display">\[\sum_{i=1}^n \frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}=0=-S(\lambda)\]</span> Then the result of EM algorithm is the same
with the MLE of observed data likelihood.</p>
</div>
<div id="section-1" class="section level4">
<h4>(2)</h4>
<p>If we have the observed values of <span class="math inline">\((u_i,
v_i),i=1,...,10\)</span> be (11,12), (8,9), (27,28), (13,14), (16,17),
(0,1), (23, 24), (10,11), (24,25), (2,3), we can solve the result as
above.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> u<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># iteration time</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>lambda[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co"># EM algorithm</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> (u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda[i<span class="dv">-1</span>]<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda[i<span class="dv">-1</span>]<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda[i<span class="dv">-1</span>]<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda[i<span class="dv">-1</span>]<span class="sc">*</span>v))<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lambda[i<span class="dv">-1</span>]</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  lambda[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(u)<span class="sc">/</span><span class="fu">sum</span>(x)</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lambda,<span class="at">ylab =</span> <span class="st">&#39;lambda&#39;</span>,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">main =</span> <span class="st">&#39;EM algorithm solution results&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>lambda[N]</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>score_function <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># solve directly</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(score_function,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>solution<span class="sc">$</span>root</span></code></pre></div>
<pre><code>## [1] 0.07196821</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">score_function</span>(lambda[N])</span></code></pre></div>
<pre><code>## [1] -2.403633e-14</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>solution<span class="sc">$</span>f.root</span></code></pre></div>
<pre><code>## [1] -0.01019994</code></pre>
<p>It can be found that, because the function form of score function is
more complex, it is not convenient to directly use the function to solve
the numerical solution, so the solution result obtained by EM algorithm
after several iterations is more accurate than that obtained by directly
solving the score function.</p>
</div>
</div>
<div id="exercises" class="section level3">
<h3>2.1.3 Exercises</h3>
<div id="question-4" class="section level4">
<h4>Question 4</h4>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
</div>
<div id="answer-4" class="section level4">
<h4>Answer 4</h4>
<p>We can take an example to see unlist() and as.vector() for a
list.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(a);<span class="fu">typeof</span>(<span class="fu">unlist</span>(a))</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.vector</span>(a);<span class="fu">typeof</span>(<span class="fu">as.vector</span>(a))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 2
## 
## [[3]]
## [1] 3
## 
## [[4]]
## [1] 4
## 
## [[5]]
## [1] 5</code></pre>
<pre><code>## [1] &quot;list&quot;</code></pre>
<p>We can see that if we use as.vector() for a list, it is still a list
but not an atomic vector, but unlist() can make the list to be atomic
vector.</p>
<p>Because it would treat a list as a whole and turn it into a
one-dimensional vector, but an unlist removes the state of a list and
therefore becomes a vector.</p>
</div>
<div id="question-5" class="section level4">
<h4>Question 5</h4>
<p>Why is 1 == “1” true? Why is -1 &lt; FALSE true? Why is “one” &lt; 2
false?</p>
</div>
<div id="answer-5" class="section level4">
<h4>Answer 5</h4>
<p>First we can see the test results as follows.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">==</span> <span class="st">&quot;1&quot;</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">1</span> <span class="sc">&lt;</span> <span class="cn">FALSE</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;one&quot;</span> <span class="sc">&lt;</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>We can see that size comparisons can also be made when the data on
both sides of the inequality and the equality are of different data
types. The above test result is due to the fact that the relational
operator will automatically convert the data on both sides into the same
type of data for size comparison.</p>
<p>The actual transformation process is as follows, hence the above
results, with as.numeric(“1”) == 1, as.numeric(FALSE) == 0 and
as.character(2) == “2” &lt; “one”.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">==</span> <span class="fu">as.numeric</span>(<span class="st">&quot;1&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">1</span> <span class="sc">&lt;</span> <span class="fu">as.numeric</span>(<span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;one&quot;</span> <span class="sc">&lt;</span> <span class="fu">as.character</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="exercises-1" class="section level3">
<h3>2.3.1 Exercises</h3>
<div id="question-1-1" class="section level4">
<h4>Question 1</h4>
<p>What does dim() return when applied to a vector?</p>
</div>
<div id="answer-1-2" class="section level4">
<h4>Answer 1</h4>
<p>We can make a test to answer, dim() for a vector will return
NULL.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="question-2-1" class="section level4">
<h4>Question 2</h4>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
</div>
<div id="answer-2-1" class="section level4">
<h4>Answer 2</h4>
<p>If is.matrix(x) is TRUE, is.array(x) will also return TRUE.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dv">2</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="exercises-2" class="section level3">
<h3>2.4.5 Exercises</h3>
<div id="question-1-2" class="section level4">
<h4>Question 1</h4>
<p>What attributes does a data frame possess?</p>
</div>
<div id="answer-1-3" class="section level4">
<h4>Answer 1</h4>
<p>The attributes of dataframe have the number of observations and
variables, also will display the details of each variable
separately.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">7</span>),<span class="at">Y=</span><span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="dv">8</span>))</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(x)</span></code></pre></div>
<pre><code>## $names
## [1] &quot;X&quot; &quot;Y&quot;
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $row.names
## [1] 1 2 3 4</code></pre>
</div>
<div id="question-2-2" class="section level4">
<h4>Question 2</h4>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
</div>
<div id="answer-2-2" class="section level4">
<h4>Answer 2</h4>
<p>Also for x, we can take as.matrix(x). Then we will see that the
dataframe is converted to a matrix, and all matrix elements will be
converted to the same data type, for example, a dataframe with numeric
and character types will be converted to a matrix with character
elements.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##   X Y
## 1 1 a
## 2 2 b
## 3 3 c
## 4 7 8</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(x)</span></code></pre></div>
<pre><code>##      X   Y  
## [1,] &quot;1&quot; &quot;a&quot;
## [2,] &quot;2&quot; &quot;b&quot;
## [3,] &quot;3&quot; &quot;c&quot;
## [4,] &quot;7&quot; &quot;8&quot;</code></pre>
</div>
<div id="question-3" class="section level4">
<h4>Question 3</h4>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
</div>
<div id="answer-3-1" class="section level4">
<h4>Answer 3</h4>
<p>You can create a dataframe with 0 rows and 0 columns, but you cannot
create a dataframe with only 0 rows or 0 columns.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">c</span>(),<span class="at">Y=</span><span class="fu">c</span>())</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
</div>
<div id="hw10" class="section level2">
<h2>HW10</h2>
<div id="exercise-2" class="section level3">
<h3>Exercise 2</h3>
<p>The function below scales a vector so it falls in the range [0,1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="answer-2-3" class="section level3">
<h3>Answer 2</h3>
<p>Because data.frame is treated as a list, and each element in the list
is treated as each of its columns, you can directly use sapply() or
lapply() to manipulate the data.frame to get the result of scaling each
column of the data.frame.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">*</span><span class="dv">10</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N);<span class="fu">dim</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">4</span>)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>data</span></code></pre></div>
<pre><code>##            X1          X2          X3          X4
## 1  -0.6264538  1.51178117  0.91897737  1.35867955
## 2   0.1836433  0.38984324  0.78213630 -0.10278773
## 3  -0.8356286 -0.62124058  0.07456498  0.38767161
## 4   1.5952808 -2.21469989 -1.98935170 -0.05380504
## 5   0.3295078  1.12493092  0.61982575 -1.37705956
## 6  -0.8204684 -0.04493361 -0.05612874 -0.41499456
## 7   0.4874291 -0.01619026 -0.15579551 -0.39428995
## 8   0.7383247  0.94383621 -1.47075238 -0.05931340
## 9   0.5757814  0.82122120 -0.47815006  1.10002537
## 10 -0.3053884  0.59390132  0.41794156  0.76317575</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>cx <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data,scale01)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>cx</span></code></pre></div>
<pre><code>##                X1        X2        X3        X4
##  [1,] 0.086047962 1.0000000 1.0000000 1.0000000
##  [2,] 0.419296552 0.6989283 0.9529486 0.4657870
##  [3,] 0.000000000 0.4276043 0.7096572 0.6450656
##  [4,] 1.000000000 0.0000000 0.0000000 0.4836918
##  [5,] 0.479300618 0.8961889 0.8971397 0.0000000
##  [6,] 0.006236443 0.5822561 0.6647195 0.3516655
##  [7,] 0.544264487 0.5899694 0.6304500 0.3592337
##  [8,] 0.647475101 0.8475922 0.1783152 0.4816783
##  [9,] 0.580609856 0.8146885 0.5196116 0.9054536
## [10,] 0.218124222 0.7536872 0.8277238 0.7823243</code></pre>
<p>If you want to scale each column of numeric type in the data.frame,
you need to output the data type of each column of the data.frame and
select its corresponding column of numeric type for scale.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co">#generate data</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;c&#39;</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>))</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,<span class="at">y=</span>y)</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>data2</span></code></pre></div>
<pre><code>##            X1          X2          X3          X4 y
## 1  -0.6264538  1.51178117  0.91897737  1.35867955 a
## 2   0.1836433  0.38984324  0.78213630 -0.10278773 a
## 3  -0.8356286 -0.62124058  0.07456498  0.38767161 a
## 4   1.5952808 -2.21469989 -1.98935170 -0.05380504 c
## 5   0.3295078  1.12493092  0.61982575 -1.37705956 c
## 6  -0.8204684 -0.04493361 -0.05612874 -0.41499456 c
## 7   0.4874291 -0.01619026 -0.15579551 -0.39428995 c
## 8   0.7383247  0.94383621 -1.47075238 -0.05931340 c
## 9   0.5757814  0.82122120 -0.47815006  1.10002537 c
## 10 -0.3053884  0.59390132  0.41794156  0.76317575 c</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>tx <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data2,<span class="cf">function</span>(x){<span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x}))</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>tx</span></code></pre></div>
<pre><code>##             X1        X2        X3        X4 y
## 1  0.086047962 1.0000000 1.0000000 1.0000000 a
## 2  0.419296552 0.6989283 0.9529486 0.4657870 a
## 3  0.000000000 0.4276043 0.7096572 0.6450656 a
## 4  1.000000000 0.0000000 0.0000000 0.4836918 c
## 5  0.479300618 0.8961889 0.8971397 0.0000000 c
## 6  0.006236443 0.5822561 0.6647195 0.3516655 c
## 7  0.544264487 0.5899694 0.6304500 0.3592337 c
## 8  0.647475101 0.8475922 0.1783152 0.4816783 c
## 9  0.580609856 0.8146885 0.5196116 0.9054536 c
## 10 0.218124222 0.7536872 0.8277238 0.7823243 c</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercise-1-1" class="section level3">
<h3>Exercise 1</h3>
<p>Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</p></li>
</ol>
</div>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<p>We can generate a data frame of numeric type and a mixed data frame
as above.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">*</span><span class="dv">10</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N);<span class="fu">dim</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">4</span>)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;c&#39;</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>))</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x) <span class="co"># numeric</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,<span class="at">y=</span>y) <span class="co"># mix</span></span></code></pre></div>
<p>Then, for the first case, refer to the previous question, replace
sapply() with vapply(), calculate the standard deviation of the data,
and output the numerical data result.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>data</span></code></pre></div>
<pre><code>##            X1          X2          X3          X4
## 1  -0.6264538  1.51178117  0.91897737  1.35867955
## 2   0.1836433  0.38984324  0.78213630 -0.10278773
## 3  -0.8356286 -0.62124058  0.07456498  0.38767161
## 4   1.5952808 -2.21469989 -1.98935170 -0.05380504
## 5   0.3295078  1.12493092  0.61982575 -1.37705956
## 6  -0.8204684 -0.04493361 -0.05612874 -0.41499456
## 7   0.4874291 -0.01619026 -0.15579551 -0.39428995
## 8   0.7383247  0.94383621 -1.47075238 -0.05931340
## 9   0.5757814  0.82122120 -0.47815006  1.10002537
## 10 -0.3053884  0.59390132  0.41794156  0.76317575</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>cx <span class="ot">&lt;-</span> <span class="fu">vapply</span>(data,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>cx</span></code></pre></div>
<pre><code>##        X1        X2        X3        X4 
## 0.7805860 1.0695148 0.9556076 0.8085646</code></pre>
<p>In the second case, vapply() is used to determine whether each column
of the data is a numeric type, and then vapply() is used to calculate
the standard deviation of the columns of the numeric type.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>data2</span></code></pre></div>
<pre><code>##            X1          X2          X3          X4 y
## 1  -0.6264538  1.51178117  0.91897737  1.35867955 a
## 2   0.1836433  0.38984324  0.78213630 -0.10278773 a
## 3  -0.8356286 -0.62124058  0.07456498  0.38767161 a
## 4   1.5952808 -2.21469989 -1.98935170 -0.05380504 c
## 5   0.3295078  1.12493092  0.61982575 -1.37705956 c
## 6  -0.8204684 -0.04493361 -0.05612874 -0.41499456 c
## 7   0.4874291 -0.01619026 -0.15579551 -0.39428995 c
## 8   0.7383247  0.94383621 -1.47075238 -0.05931340 c
## 9   0.5757814  0.82122120 -0.47815006  1.10002537 c
## 10 -0.3053884  0.59390132  0.41794156  0.76317575 c</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>tx <span class="ot">&lt;-</span> <span class="fu">vapply</span>(data2[,<span class="fu">vapply</span>(data2, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>tx</span></code></pre></div>
<pre><code>##        X1        X2        X3        X4 
## 0.7805860 1.0695148 0.9556076 0.8085646</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<div id="exiercise" class="section level3">
<h3>Exiercise</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9.</p>
<ol style="list-style-type: decimal">
<li><p>Write an Rcpp function.</p></li>
<li><p>Compare the corresponding generated random numbers with pure R
language using the function “qqplot”.</p></li>
<li><p>Compare the computation time of the two functions with the
function “microbenchmark”.</p></li>
</ol>
</div>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<div id="section-2" class="section level4">
<h4>(1)</h4>
<p>Since we have <span class="math display">\[\left(\begin{array}{c}
X \\
Y \\
\end{array}
\right)\sim N(\left[\begin{array}{c}
\mu_x \\
\mu_y \\
\end{array}
\right],\left[\begin{array}{cc}
\sigma_{11} &amp; \sigma_{12} \\
\sigma_{21} &amp; \sigma_{22} \\
\end{array}
\right]) = N(\left[\begin{array}{c}
0 \\
0 \\
\end{array}
\right],\left[\begin{array}{cc}
1 &amp; 0.9 \\
0.9 &amp; 1 \\
\end{array}
\right])\]</span></p>
<p>then we have</p>
<p><span class="math display">\[X|Y=y\sim
N(\mu_x+\sigma_{12}\sigma_{22}^{-1}(y-\mu_y),\sigma_{11}-\sigma_{12}\sigma_{22}^{-1}\sigma_{21})=N(0.9y,0.19)\]</span>
<span class="math display">\[Y|X=x\sim
N(\mu_y+\sigma_{21}\sigma_{11}^{-1}(x-\mu_x),\sigma_{22}-\sigma_{21}\sigma_{11}^{-1}\sigma_{12})=N(0.9x,0.19)\]</span>
Therefore, we can use Gibbs method to generate <span class="math inline">\((X_t,Y_t)\)</span> at each step.</p>
<p>So, firstly we can write a Rcpp function to fulfill Gibbs sampling as
follow.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>NumericMatrix RandomC<span class="op">(</span><span class="dt">double</span> x0<span class="op">,</span><span class="dt">double</span> y0<span class="op">,</span> <span class="dt">int</span> N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  NumericMatrix out<span class="op">(</span>N<span class="op">,</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>  out<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">)</span> <span class="op">=</span> x0<span class="op">;</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>  out<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">)</span> <span class="op">=</span> y0<span class="op">;</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">1</span><span class="op">;</span>i <span class="op">&lt;</span> N<span class="op">;</span>i<span class="op">++){</span></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>    NumericVector temp <span class="op">=</span> rnorm<span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="fl">0.9</span><span class="op">*</span>out<span class="op">(</span>i<span class="op">-</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">),</span>sqrt<span class="op">(</span><span class="fl">0.19</span><span class="op">));</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>    out<span class="op">(</span>i<span class="op">,</span><span class="dv">0</span><span class="op">)</span> <span class="op">=</span> temp<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>    NumericVector temp2 <span class="op">=</span> rnorm<span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="fl">0.9</span><span class="op">*</span>out<span class="op">(</span>i<span class="op">,</span><span class="dv">0</span><span class="op">),</span>sqrt<span class="op">(</span><span class="fl">0.19</span><span class="op">));</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>    out<span class="op">(</span>i<span class="op">,</span><span class="dv">1</span><span class="op">)</span> <span class="op">=</span> temp2<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> out<span class="op">;</span></span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="section-3" class="section level4">
<h4>(2)</h4>
<p>Besides, we also can write a R function to fulfill Gibbs sampling as
follow.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>RandomR <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x0=</span><span class="dv">0</span>,<span class="at">y0=</span><span class="dv">0</span>,<span class="at">N=</span><span class="fl">1e3</span>){</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0;y[<span class="dv">1</span>] <span class="ot">&lt;-</span> y0</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.9</span><span class="sc">*</span>y[i<span class="dv">-1</span>],<span class="fu">sqrt</span>(<span class="fl">0.19</span>))</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.9</span><span class="sc">*</span>x[i],<span class="fu">sqrt</span>(<span class="fl">0.19</span>))</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We then run the two functions with the same initial value and the
number of random numbers generated and get the results.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;../src/RandomC.cpp&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;D:/
## Rpackage/StatComp22074/src/../inst/include&quot;: 系统找不到指定的文件。</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e3</span>;x0 <span class="ot">&lt;-</span> <span class="dv">0</span>;y0 <span class="ot">&lt;-</span> <span class="dv">0</span>;</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rcpp function</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>ResultC <span class="ot">&lt;-</span> <span class="fu">RandomC</span>(x0,y0,N)</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R function</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>ResultR <span class="ot">&lt;-</span> <span class="fu">RandomR</span>(x0,y0,N)</span></code></pre></div>
<p>Then draw the Q-Q plot of x and y of the results of the two functions
respectively.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(ResultC[,<span class="dv">1</span>],ResultR<span class="sc">$</span>x,<span class="at">xlab=</span><span class="st">&#39;X(Rcpp)&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;X(R)&#39;</span>,<span class="at">main=</span><span class="st">&#39;Q-Q plot for X&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(ResultC[,<span class="dv">2</span>],ResultR<span class="sc">$</span>y,<span class="at">xlab=</span><span class="st">&#39;Y(Rcpp)&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Y(R)&#39;</span>,<span class="at">main=</span><span class="st">&#39;Q-Q plot for Y&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can find that the two Q-Q plot are roughly presented as a straight
line, so we can conclude that the random numbers generated by the two
functions obey the same distribution.</p>
</div>
<div id="section-4" class="section level4">
<h4>(3)</h4>
<p>Meanwhile, we can use the microbenchmark package to compare the
running time of the two functions. It can be found that the running time
of the Rcpp function is much lower than that of the R function, and the
time of the Rcpp function is less than one tenth of the time of the R
function.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">ResultC =</span> <span class="fu">RandomC</span>(x0,y0,N),<span class="at">ResultR =</span> <span class="fu">RandomR</span>(x0,y0,N))</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##      expr       lq   median      uq
## 1 ResultC   884.05  1112.35  1501.2
## 2 ResultR 16307.65 20100.95 29825.2</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
